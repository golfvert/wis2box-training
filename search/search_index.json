{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#wis2-in-a-box-training","title":"WIS2 in a box training","text":"<p>WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.</p> <p>This training provides step-by-step explanations of various aspects of the wis2box project as well as a number of exercises to help you publish and download data from WIS2.  The training is provided in the form of overview presentations as well as hands-on practical exercises.</p> <p>Participants will be able to work with sample test data and metadata, as well as integrate their own data and metadata.</p> <p>This training covers a wide range of topics (install/setup/configuration, publishing/downloading data, etc.).</p>"},{"location":"#navigation","title":"Navigation","text":"<p>The left hand navigation provides a table of contents for the entire training.</p> <p>The right hand navigation provides a table of concents for a specific page.</p>"},{"location":"#prerequisites","title":"Prerequisites","text":""},{"location":"#knowledge","title":"Knowledge","text":"<ul> <li>Basic Linux commands (see the cheatsheet)</li> <li>Basic knowledge of networking and Internet protocols</li> </ul>"},{"location":"#software","title":"Software","text":"<p>This training requires the following tools:</p> <ul> <li>An instance running Ubuntu OS with Docker and docker-composer (see training-environment)</li> <li>SSH client to access your instance</li> <li>MQTT Explorer on your local machine</li> </ul>"},{"location":"#goals-and-learning-outcomes","title":"Goals and learning outcomes","text":"<p>The goals of this training are to become familiar with the following:</p> <ul> <li>WIS2 concepts and core functions and components</li> <li>Required and optional functions of a WIS2 Node</li> <li>WIS2 in a box architecture and environment</li> <li>data and metadata formats used in WIS2 for discovery and access</li> <li>wis2box core functions:<ul> <li>sending data</li> <li>registering as a WIS2 Node</li> <li>downloading data from broker</li> <li>monitoring operations</li> </ul> </li> </ul>"},{"location":"#conventions","title":"Conventions","text":"<p>Question</p> <p>A section marked like this invites you to answer a question.</p> <p>Also you will notice tips and notes sections within the text:</p> <p>Tip</p> <p>Tips share help on how to best achieve tasks.</p> <p>Note</p> <p>Notes provide additional information on the topic covered by the practical session, as well as how to best achieve tasks.</p> <p>Examples are indicated as follows:</p> <p>Configuration <pre><code>my-collection-defined-in-yaml:\ntype: collection\ntitle: my title defined as a yaml attribute named title\ndescription: my description as a yaml attribute named description\n</code></pre></p> <p>Snippets which need to be typed in a on a terminal/console are indicated as:</p> <pre><code>echo 'Hello world'\n</code></pre>"},{"location":"#training-location-and-materials","title":"Training location and materials","text":"<p>This training is always provided live at https://training.wis2box.wis.wmo.int.</p> <p>The training contents, wiki and issue tracker are managed on GitHub at https://github.com/wmo-im/wis2box-training.</p>"},{"location":"#printing-the-material","title":"Printing the material","text":"<p>This training can be exported to PDF.  To save or print this training material, go to the print page, and select File &gt; Print &gt; Save as PDF.</p>"},{"location":"#exercise-materials","title":"Exercise materials","text":"<p>Exercise materials can be downloaded from the exercise-materials.zip zipfile.</p>"},{"location":"#support","title":"Support","text":"<p>For issues/bugs/suggestions or improvements/contributions to this training, please use the GitHub issue tracker.</p> <p>All wis2box bugs, enhancements and issues can be reported on GitHub.</p> <p>For additional support of questions, please contact wis@wmo.int.</p> <p>As always, wis2box core documentation can always be found at https://docs.wis2box.wis.wmo.int.</p> <p>Contributions are always encouraged and welcome!</p>"},{"location":"overviews/","title":"Overviews","text":"<p>The following presentations provide conceptual overviews presented during the training:</p> <ul> <li>WIS2-pilot-phase</li> <li>WIS 2.0 Architecture</li> <li>Introducing WIS2 in a box</li> <li>WIS 2 box case studies (Malawi)</li> <li>Training environment</li> <li>BUFR in a nutshell</li> <li>BUFR and ecCodes</li> <li>WIS2 in a box project and installation</li> <li>WIS2 in a box architecture</li> <li>Register your WIS2 node in WIS2</li> <li>Sharing a new station with WMO</li> </ul>"},{"location":"cheatsheets/docker/","title":"Docker cheatsheet","text":""},{"location":"cheatsheets/docker/#overview","title":"Overview","text":"<p>Docker allows for creating virtual envronments in an isolated manner in support of virtualization of computing resources.  The basic concept behind Docker is containerization, where software can run as services, interacting with other software containers, for example.</p> <p>The typical Docker workflow involves creating and building images, which are then run as live containers.</p>"},{"location":"cheatsheets/docker/#image-management","title":"Image management","text":"<ul> <li>List available images</li> </ul> <pre><code>docker images\n</code></pre> <ul> <li>Build an image from a Dockerfile:</li> </ul> <pre><code>cat &lt;&lt; EOF &gt; Dockerfile\nFROM ubuntu:latest\n\nRUN apt-get update\nRUN apt-get install \u2013y nginx\n\nCMD [\"echo\", \"Hello from my first Docker setup!\"]\nEOF\n</code></pre> <ul> <li>Building the image:</li> </ul> <pre><code>docker build -t my-image:local .\n</code></pre> <ul> <li>Removing an image:</li> </ul> <pre><code>docker rmi my-image:local\n</code></pre>"},{"location":"cheatsheets/docker/#volume-management","title":"Volume Management","text":"<ul> <li>List all created volumes:</li> </ul> <pre><code>docker volume ls\n</code></pre> <ul> <li>Create a volume:</li> </ul> <pre><code>docker volume create my-volume\n</code></pre> <ul> <li>Display detailed information on a volume:</li> </ul> <pre><code>docker volume inspect my-volume\n</code></pre> <ul> <li>Remove a volume:</li> </ul> <pre><code>docker volume rm my-volume\n</code></pre> <ul> <li>Remove all unused volumes:</li> </ul> <pre><code>docker volume prune\n</code></pre>"},{"location":"cheatsheets/docker/#container-management","title":"Container Management","text":"<ul> <li>Create a container from an image, with an interactive terminal (<code>-it</code>) and a mounted volume (<code>v</code>):</li> </ul> <pre><code>docker run -it -v ${pwd}:/app my-image:local\n</code></pre> <ul> <li>Display a list of currently running containers:</li> </ul> <pre><code>docker ps\n</code></pre> <ul> <li>List of all containers:</li> </ul> <pre><code>docker ps -a\n</code></pre> <ul> <li>Start a container:</li> </ul> <pre><code>docker start my-image:local  # starts a new container\n</code></pre> <ul> <li>Enter the interactive terminal of a running container:</li> </ul> <p>Tip</p> <p>use <code>docker ps</code> to use the container id in the command below</p> <pre><code>docker exec -it my-container /bin/bash\n</code></pre> <ul> <li>Remove a container</li> </ul> <pre><code>docker rm my-container\n</code></pre> <ul> <li>Remove a running container:</li> </ul> <pre><code>docker rm -f my-container\n</code></pre>"},{"location":"cheatsheets/linux/","title":"Linux cheatsheet","text":""},{"location":"cheatsheets/linux/#overview","title":"Overview","text":"<p>The basic concepts of working in a Linux operating system are files and directories (folders) organized in a tree structure within an environment.</p> <p>Once you login to a Linux system, you are working in a shell in which you can work on files and directories, by executing commands which are installed on the system.  The Bash shell is a common and popular shell which is typically found on Linux systems.</p>"},{"location":"cheatsheets/linux/#bash","title":"Bash","text":""},{"location":"cheatsheets/linux/#directory-navigation","title":"Directory Navigation","text":"<ul> <li>Entering an absolute directory:</li> </ul> <pre><code>cd /dir1/dir2\n</code></pre> <ul> <li>Entering a relative directory:</li> </ul> <pre><code>cd ./somedir\n</code></pre> <ul> <li>Move one directory up:</li> </ul> <pre><code>cd ..\n</code></pre> <ul> <li>Move two directories up:</li> </ul> <pre><code>cd ../..\n</code></pre> <ul> <li>Move to your \"home\" directory:</li> </ul> <pre><code>cd -\n</code></pre>"},{"location":"cheatsheets/linux/#file-management","title":"File Management","text":"<ul> <li>Listing files in the current directory:</li> </ul> <pre><code>ls\n</code></pre> <ul> <li>Listing files in the current directory with more detail:</li> </ul> <pre><code>ls -l\n</code></pre> <ul> <li>List the root of the filessystem:</li> </ul> <pre><code>ls -l /\n</code></pre> <ul> <li>Create an empty file:</li> </ul> <pre><code>touch foo.txt\n</code></pre> <ul> <li>Create a file from an <code>echo</code> command:</li> </ul> <pre><code>echo \"hi there\" &gt; test-file.txt\n</code></pre> <ul> <li>Copy a file:</li> </ul> <pre><code>cp file1 file2\n</code></pre> <ul> <li>Concatenate two files into a new file called <code>newfile</code>:</li> </ul> <pre><code>cat file1 file2 &gt; newfile\n</code></pre> <ul> <li>Append another file into <code>newfile</code></li> </ul> <pre><code>cat file3 &gt;&gt; newfile\n</code></pre> <ul> <li>Delete a file:</li> </ul> <pre><code>rm newfile\n</code></pre> <ul> <li>Delete all files with the same file extension:</li> </ul> <pre><code>rm *.dat\n</code></pre> <ul> <li>Create a directory</li> </ul> <pre><code>mkdir dir1\n</code></pre>"},{"location":"cheatsheets/linux/#chaining-commands-together-with-pipes","title":"Chaining commands together with pipes","text":"<p>Pipes allow a user to send the output of one command to another using the pipe <code>|</code> symbol:</p> <pre><code>echo \"hi\" | sed 's/hi/bye/'\n</code></pre> <ul> <li>Filtering command outputs using grep:</li> </ul> <pre><code>echo \"id,title\" &gt; test-file.txt\necho \"1,birds\" &gt;&gt; test-file.txt\necho \"2,fish\" &gt;&gt; test-file.txt\necho \"3,cats\" &gt;&gt; test-file.txt\n\ncat test-file.txt | grep fish\n</code></pre> <ul> <li>Ignoring case:</li> </ul> <pre><code>grep -i FISH test-file.txt\n</code></pre> <ul> <li>Count matching lines:</li> </ul> <pre><code>grep -c fish test-file.txt\n</code></pre> <ul> <li>Return outputs not containing keyword:</li> </ul> <pre><code>grep -v birds test-file.txt\n</code></pre> <ul> <li>Count the number of lines in <code>test-file.txt</code>:</li> </ul> <pre><code>wc -l test-file.txt\n</code></pre> <ul> <li>Display output one screen at a time:</li> </ul> <pre><code>more test-file.txt\n</code></pre> <p>...with controls:</p> <ul> <li>Scroll down line by line: enter</li> <li>Go to next page: space bar</li> <li> <p>Go back one page: b</p> </li> <li> <p>Display the first 3 lines of the file:</p> </li> </ul> <pre><code>head -3 test-file.txt\n</code></pre> <ul> <li>Display the last 2 lines of the file:</li> </ul> <pre><code>tail -2 test-file.txt\n</code></pre>"},{"location":"cheatsheets/wis2box/","title":"WIS2 in a box cheatsheet","text":""},{"location":"cheatsheets/wis2box/#overview","title":"Overview","text":"<p>wis2box runs as a suite of Docker Compose commands.  The <code>wis2box-ctl.py</code> command is a utility (written in Python) to run Docker Compose commands easily.</p>"},{"location":"cheatsheets/wis2box/#wis2box-command-essentials","title":"wis2box command essentials","text":""},{"location":"cheatsheets/wis2box/#building","title":"Building","text":"<ul> <li>Build all of wis2box:</li> </ul> <pre><code>python3 wis2box-ctl.py build\n</code></pre> <ul> <li>Build a specific wis2box Docker image:</li> </ul> <pre><code>python3 wis2box-ctl.py build wis2box-management\n</code></pre> <ul> <li>Update wis2box:</li> </ul> <pre><code>python3 wis2box-ctl.py update\n</code></pre>"},{"location":"cheatsheets/wis2box/#starting-and-stopping","title":"Starting and stopping","text":"<ul> <li>Start wis2box:</li> </ul> <pre><code>python3 wis2box-ctl.py start\n</code></pre> <ul> <li>Stop wis2box:</li> </ul> <pre><code>python3 wis2box-ctl.py stop\n</code></pre> <ul> <li>Verify all wis2box containers are running:</li> </ul> <pre><code>python3 wis2box-ctl.py status\n</code></pre> <ul> <li>Login to a wis2box container (wis2box-management by default):</li> </ul> <pre><code>python3 wis2box-ctl.py login\n</code></pre> <ul> <li>Login to a specific wis2box container:</li> </ul> <pre><code>python3 wis2box-ctl.py login wis2box-api\n</code></pre>"},{"location":"cheatsheets/wis2box/#design-time-commands-metadata-management-and-publishing","title":"Design time commands (metadata management and publishing)","text":"<p>Note</p> <p>You must be logged into the wis2box-management container to run the below commands</p> <ul> <li>Publish discovery metadata:</li> </ul> <pre><code>wis2box metadata discovery publish /path/to/discovery-metadata-file.yml\n</code></pre> <ul> <li>Publish station metadata:</li> </ul> <pre><code>wis2box metadata station publish-collection\n</code></pre> <ul> <li>Add a dataset of observation collections from discovery metadata:</li> </ul> <pre><code>wis2box data add-collection /path/to/discovery-metadata-file.yml\n</code></pre> <ul> <li>Ingest data into the wis2box-incoming bucket to trigger processing and publishing:</li> </ul> <pre><code>wis2box data ingest --topic-hierarchy topic.hierarchy.path --path /path/to/directory/of/data/files\n</code></pre>"},{"location":"practical-sessions/access-your-student-vm/","title":"Access your student VM","text":""},{"location":"practical-sessions/access-your-student-vm/#introduction","title":"Introduction","text":"<p>In this session you will ensure you can connect to your student VM, check pre-installed software and download the exercise materials.</p> <p>As part of locally run wis2box training sessions, you can access your personal student VM on the local training network named \"WIS2-training\".</p> <p>If you want to run this training outside of a local training session, you can provide your own instance as detailed in the training environment overview.</p>"},{"location":"practical-sessions/access-your-student-vm/#connect-to-your-student-vm-on-the-local-training-network","title":"Connect to your student VM on the local training network","text":"<p>Use the following configuraiton to connect your PC on the local WiFi broadcasted in the room during WIS2 training:</p> <ul> <li>SSID: WIS2-training</li> <li>password: dataismagic!</li> </ul> <p>Use an SSH client to connect to your student VM using the following:</p> <ul> <li>Host: country-lastname.wis2box.training (replace with your country and lastname)</li> <li>Port: 22</li> <li>Username: lastname (replace with your lastname)</li> <li>Password: namibia2023</li> </ul> <p>Tip</p> <p>Contact a trainer if you are unsure about the hostname or have issues connecting.</p> <p>Once connected, please change your password to ensure others cannot access your VM:</p> <pre><code>limper@student-vm:~$ passwd\nChanging password for limper.\nCurrent password:\nNew password:\nRetype new password:\npasswd: password updated successfully\n</code></pre>"},{"location":"practical-sessions/access-your-student-vm/#verify-software-versions","title":"Verify software versions","text":"<p>Your student VM comes with Python, Docker and Docker Compose pre-installed.</p> <p>Check docker version: <pre><code>docker --version\n</code></pre> returns: <pre><code>Docker version 20.10.17, build 100c701\n</code></pre></p> <p>Check Docker Compose version: <pre><code>docker-compose --version\n</code></pre> returns: <pre><code>docker-compose version 1.29.2, build unknown\n</code></pre></p> <p>Check Python version: <pre><code>python3 --version\n</code></pre> returns: <pre><code>Python 3.8.10\n</code></pre></p>"},{"location":"practical-sessions/access-your-student-vm/#run-docker-hello-world","title":"Run docker 'hello-world'","text":"<p>In the local training environment, your student account has been added to the <code>docker</code> group to allow you to work with Docker.  You can verify this by running the Docker <code>hello-world</code> image:</p> <pre><code>docker run -it hello-world\n</code></pre> <p>This command downloads the <code>hello-world</code> image from the local registry and interactively runs a Docker container for this image.</p> <p>Tip</p> <p>If you get an error it is often an indication that your username does not have the appropriate permissions to access the Docker filesystem.  The user running Docker commands must be added to the <code>docker</code> group in order to run Docker containers.</p>"},{"location":"practical-sessions/access-your-student-vm/#review-docker-system-usage","title":"Review Docker system usage","text":"<p>Inspect youf local Docker system usage using the command:</p> <pre><code>docker system df\n</code></pre> <p>Question</p> <p>What usage can you currently observe for your Docker system?</p> <p>Cleanup your Docker system with the command:</p> <pre><code>docker system prune -a\n</code></pre> <p>Verify Docker system is now clean of any Docker resources: <pre><code>docker system df\n</code></pre></p> <p>should return: <pre><code>TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE\nImages          0         0         0B        0B\nContainers      0         0         0B        0B\nLocal Volumes   0         0         0B        0B\nBuild Cache     0         0         0B        0\n</code></pre></p>"},{"location":"practical-sessions/access-your-student-vm/#download-the-exercise-materials","title":"Download the exercise materials","text":"<p>Please download the exercise materials to your local VM and extract the archive with the following commands:</p> <pre><code>wget https://wmo-im.github.io/wis2box-training/exercise-materials.zip\nunzip exercise-materials.zip\n</code></pre> <p>Inspect the contents of the <code>exercise-materials</code> directory; these are the materials used as part of the training and practical sessions.</p> <pre><code>cd exercise-materials\nls\n</code></pre> <p>Return to your previous directory:</p> <pre><code>cd ..\n</code></pre>"},{"location":"practical-sessions/access-your-student-vm/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned how to:</p> <ul> <li>access your student VM over SSH</li> <li>verify the versions of Python, Docker and Docker Compose on your local student VM</li> <li>verify that Docker commands can be successfully run</li> <li>check Docker system resource usage</li> <li>download, extract and review the exercise materials for this training on your local student VM</li> </ul>"},{"location":"practical-sessions/configuring-data-mappings/","title":"Configuring data mappings","text":""},{"location":"practical-sessions/configuring-data-mappings/#introduction","title":"Introduction","text":"<p>wis2box uses a number of configuration files to allow for a simple setup of the system.  At the heart of wis2box is data ingest and publishing, which are driven by wis2box data mappings.  The basic concept of data mappings is configuring a WIS2 topic to a defined ingest and publish workflow and files/templates.  In this session, you will work on adding to the data mappings in support of publishing your data via wis2box.</p>"},{"location":"practical-sessions/configuring-data-mappings/#preparation","title":"Preparation","text":"<p>Note</p> <p>Ensure you are logged into the wis2box-management container on your student VM: </p> <pre><code>cd ~/exercise-materials/wis2box-setup\npython3 wis2box-ctl.py login\n</code></pre>"},{"location":"practical-sessions/configuring-data-mappings/#configure-a-data-mapping","title":"Configure a data mapping","text":"<p>Note</p> <p>Ensure you are logged into the wis2box-management container before continuing.</p> <p>Inspect the wis2box environnment to locate the data mappings in use by the system, as defined by the <code>WIS2BOX_DATA_MAPPINGS</code> environment variable:</p> <pre><code>wis2box environment show | grep WIS2BOX_DATA_MAPPINGS\n</code></pre> <p>Question</p> <p>Where are the live data mappings located?</p> <p>Question</p> <p>How can using the <code>$WIS2BOX_DATA_MAPPINGS</code> environment variable be valuable, as compared to <code>/data/wis2box/data-mappings.yml</code>?</p>"},{"location":"practical-sessions/configuring-data-mappings/#add-csv-data","title":"Add CSV data","text":"<p>Let's add a data mapping for wis2box to process CSV data.  Inspect the contents of the sample SYNOP CSV data mapping:</p> <pre><code>cat ~/exercise-materials/wis2box-setup/synop-csv-mappings.yml\n</code></pre> <p>Question</p> <p>What topic is defined in this mapping?  What values of the topic are placeholders to be updated later in this session?</p> <p>Copy and paste the above file contents into the <code>$WIS2BOX_DATA_MAPPINGS</code> file (either manually or via the command below)::</p> <pre><code>tail -n +2 exercise-materials/wis2box-setup/test-data/data-mappings.yml &gt;&gt; $WIS2BOX_DATA_MAPPINGS\n</code></pre> <p>Tip</p> <p>Be sure that the first <code>data:</code> line from the above file is omitted when copying/pasting into the <code>$WIS2BOX_DATA_MAPPINGS</code> file.</p> <p>Open the data mappings file:</p> <pre><code>vi $WIS2BOX_DATA_MAPPINGS\n</code></pre> <p>Verify that the file you copied from <code>~/exercise-materials/wis2box-setup/synop-csv-mappings.yml</code> is now part of the live data mappings file.</p> <p>Update the <code>[country]</code> and <code>[centre_id]</code> values in your new/added data mapping.</p> <p>Tip</p> <p>The <code>country</code> value should match one of the countries in the country list of the WIS2 Topic Hierarchy.</p> <p>Tip</p> <p>The <code>centre_id</code> value should match one of the countries in the country list of the WIS2 Topic Hierarchy and <code>centre_id</code> values should be lower case and contain no accents or special characters. Dashes should be used instead of underscores.</p> <p>Note</p> <p>The <code>file-pattern</code> values throughout the data mapping provide a regular expression to be able to match filenames.  Ensure your filenames are formatted as per the regular expression in the new data mapping, to include <code>WIGOS_</code> as a fixed value, followed by the WIGOS Station Identifier (WSI), followed by an underscore (<code>_</code>), as well as any other information (i.e. datestamp).  Ensure the file extension is <code>.csv</code>.  An real world example would be <code>WIGOS_0-454-2-AWSBALAKA_2021-11-18T0955.csv</code>.</p> <p>Note</p> <p>centre id's will officially managed and introduced as part of the WIS2 Topic Hierarchy throughout the WIS2 Pilot Phase.</p>"},{"location":"practical-sessions/configuring-data-mappings/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned how to:</p> <ul> <li>inspect the live wis2box data mappings</li> <li>add a new data mapping</li> <li>update the <code>country</code> and <code>centre_id</code> values add a new data mapping</li> <li>update the <code>file-pattern</code> value to match your data filename convention</li> </ul>"},{"location":"practical-sessions/configuring-station-metadata/","title":"Configuring station metadata","text":"<p>wis2box requires station metadata to be able to process and publish observations to WIS2. This session will walk you through creating and publishing station metadata from wis2box from a configuration file.  wis2box uses a fixed station metadata list that is used as part of its runtime operation.</p>"},{"location":"practical-sessions/configuring-station-metadata/#preparation","title":"Preparation","text":"<p>Note</p> <p>Ensure you are logged into the wis2box-management container on your student VM: </p> <pre><code>cd ~/exercise-materials/wis2box-setup\npython3 wis2box-ctl.py login\n</code></pre>"},{"location":"practical-sessions/configuring-station-metadata/#creating-station-metadata","title":"Creating station metadata","text":"<p>Update the file <code>~/exercises-metadata/test-data/metadata/station/station_list.csv</code>, adding your new station:</p> <pre><code>vi ~/exercises-metadata/test-data/metadata/station/station_list.csv\n</code></pre> <p>For each new station, add a row to the end of the file with the following values:</p> <ul> <li><code>station_name</code>: the human readable name of the station</li> <li><code>wigos_station_identifier</code>: the WSI issued for the station</li> <li><code>traditional_station_identifier</code>: the traditional station identifier if a WSI does not exist</li> <li><code>facility_type</code>: the station/platform type (use Land (fixed) for land stations)</li> <li><code>latitude</code>: the latitude, in decimal degrees</li> <li><code>longitude</code>: the longitude, in decimal degrees</li> <li><code>elevation</code>: station elevation, in metres above sea level</li> <li><code>territory_name</code>: the human readable country name</li> <li><code>wmo_region</code>: the Roman numeral of your country based on WMO Regional Associations</li> </ul> <p>Tip</p> <p>You can also derive your station information from the WMO OSCAR/Surface system.</p> <p>Tip</p> <p>Ensure that latitude and longitude values are correctly signed (for example, use the minus sign [<code>-</code>] for southern or western hemispheres.</p>"},{"location":"practical-sessions/configuring-station-metadata/#publishing-station-metadata","title":"Publishing station metadata","text":"<p>Run the following command to publish your station metadata:</p> <pre><code>wis2box metadata station discovery publish-collection\n</code></pre> <p>Ensure that your new station metadata was published to the API, by navigating to <code>http://&lt;your-host&gt;/oapi/collections/stations</code>.</p> <p>Question</p> <p>Do you see your new station metadata?</p> <p>Click on your station metadata record and inspect the content, noting how it relates to the station list configuration updated earlier in this session.</p>"},{"location":"practical-sessions/configuring-station-metadata/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned how to:</p> <ul> <li>update station metadata</li> <li>publish station metadata</li> </ul>"},{"location":"practical-sessions/configuring-wis2-discovery-metadata/","title":"Configuring WIS2 discovery metadata","text":"<p>As described in the overviews, WIS2 requires discovery metadata to be provided describing your data to be shared to WIS2 Global Services.  This session will walk you through creating and publishing discovery metadata from wis2box from a configuration file.</p>"},{"location":"practical-sessions/configuring-wis2-discovery-metadata/#preparation","title":"Preparation","text":"<p>Note</p> <p>Ensure you are running MQTT Explorer and you are connected to the broker on your student VM before continuing.</p> <p>Note</p> <p>Ensure you are logged into the wis2box-management container on your student VM: </p> <pre><code>cd ~/exercise-materials/wis2box-setup\npython3 wis2box-ctl.py login\n</code></pre>"},{"location":"practical-sessions/configuring-wis2-discovery-metadata/#creating-discovery-metadata","title":"Creating discovery metadata","text":"<p>Copy the test discovery metadata into your own file (you may name the file whatever you wish):</p> <pre><code>cp ~/exercise-materials/wis2box-setup/test-data/mwi-surface-weather-observations.yml ~/my-discovery-metadata.yml\n</code></pre> <p>Inspect the sample discovery metadata:</p> <pre><code>more ~/my-discovery-metadata.yml\n</code></pre> <p>Note</p> <p>All values in the discovery metadata configuration are required and shoud be included.</p> <p>Question</p> <p>How does line 3 of your discovery metadata file relate to the new data mapping in the previous session?</p> <p>Update the following values in the discovery metadata configuration:</p> <ul> <li><code>wis2box.topic_hierarchy</code>: the topic hierarchy that categorizes the data (this value should be the same as the definition in your newly create data mapping).</li> <li><code>wis2box.country</code>: 3-letter country code in lower case</li> <li><code>wis2box.centre_id</code>: your centre id as defined in the previous exercise</li> <li><code>metadata.identifier</code>: a unique identifier consisting of <code>urn:x-wmo:md:[country]:[centre_id]:[dataset_name]</code>, where <code>[dataset-name]</code> can be any name of your choosing</li> <li><code>identification.title</code>: a human readable title describing your data</li> <li><code>identification.abstract</code>: a human readable description describing your data</li> <li><code>identification.dates.creation</code>: when the discovery metadata was created (today's date)</li> <li><code>identification.extents.spatial (bbox)</code>: the bounding box coordinates of your data (minimum longitude, minimum latitude, maximum longitude, maximum latitude), in decimal degrees</li> <li><code>identification.extents.temporal (begin)</code>: the begin and end time of your data (keeping the end time to <code>null</code> is suitable to ongoing observations)</li> <li><code>contact.pointOfContact</code>: your organization's point of contact information</li> </ul> <p>Tip</p> <p>The configuration is based on the YAML format.  Ensure your config is propertly indented (4 spaces).</p> <p>Tip</p> <p>Ensure that bbox values are correctly signed (for example, use the minus sign [<code>-</code>] for southern or western hemispheres.</p>"},{"location":"practical-sessions/configuring-wis2-discovery-metadata/#publishing-discovery-metadata","title":"Publishing discovery metadata","text":"<p>Run the following command to publish your discovery metadata:</p> <pre><code>wis2box metadata discovery publish ~/my-discovery-metadata.yml\n</code></pre> <p>Ensure that your discovery metadata was published to the API, by navigating to <code>http://&lt;your-host&gt;/oapi/collections/discovery-metadata</code>.</p> <p>Ensure that your discovery metadata was also published to the broker, by looking for a new metadata message in MQTT Explorer.</p> <p>Question</p> <p>Do you see your new discovery metadata in the API?</p> <p>Click on your discovery metadata record and inspect the content, noting how it relates to the discovery metadata configuration created earlier in this session.</p> <p>Update the title of your discovery metadata, and re-publish:</p> <pre><code>vi ~/my-discovery-metadata.yml\nwis2box metadata discovery publish ~/my-discovery-metadata.yml\n</code></pre> <p>Ensure that your discovery metadata updates were published to the API, by refreshing the page to your discovery metadata.</p> <p>Question</p> <p>Are you able to see the updates you made in the configuration?</p> <p>Feel free to update additional values and re-publishing your discovery metadata to get a better idea of how and where discovery metadata content is updated.</p>"},{"location":"practical-sessions/configuring-wis2-discovery-metadata/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned how to:</p> <ul> <li>create discovery metadata</li> <li>publish discovery metadata</li> <li>update and re-publish discovery metadata</li> </ul>"},{"location":"practical-sessions/connecting-to-mqtt/","title":"Connecting to WIS2 over MQTT","text":""},{"location":"practical-sessions/connecting-to-mqtt/#introduction","title":"Introduction","text":"<p>WIS2 uses the MQTT protocol to advertise the availability of weather/climate/water data. The WIS2 Global Broker subscribes to all WIS2 Nodes in the network and republishes the messages it receives. The Global Cache subscribes to the Global Broker, downloads the data in the message and then republishes the message on the <code>cache</code> topic with a new URL.  The Global Discovery Catalogue publishes discovery metadata from the Broker and provides a search API.</p> <p>As part of the WIS2 Pilot Phase in 2023, M\u00e9t\u00e9o-France is running a Global Broker.  In this practical session you will learn how to use the MQTT Explorer tool to review the topics available on this Global Broker and be able to display WIS2 notification messages.</p>"},{"location":"practical-sessions/connecting-to-mqtt/#using-mqtt-explorer-to-connect-to-the-global-broker","title":"Using MQTT Explorer to connect to the Global Broker","text":"<p>One way to view messages published by this Global Broker is using the MQTT Explorer which can be downloaded from the MQTT Explorer website.</p> <p>Open MQTT Explorer and add a new connection as follows:</p> <p></p> <p>Click on the 'ADVANCED' button and add the following topics to subscribe to:</p> <p></p> <p>Note</p> <p>When setting up MQTT subscriptions you can use the following wildcards:</p> <ul> <li>Single-level (+): a single-level wildcard replaces one topic level</li> <li>Multi-level (#): a multi-level wildcard replaces multiple topic levels</li> </ul> <p>Click 'BACK', then 'SAVE' to save your connection and subscription details.  Then click 'CONNECT':</p> <p>At this point, the following should appear in the MQTT Explorer session:</p> <p></p> <p>You are now ready to start exploring the WIS2 topics and message structure and answer the following questions:</p> <p>Question</p> <p>How can we distinguish the originating country providing the data?  How many countries are sharing data?</p> <p>Question</p> <p>Find the latest message received in the following topic:</p> <p><code>origin/a/wis2/mwi/malawi_wmo_demo/data/core/weather/surface-based-observations/synop</code></p> <p>What is the the value of the URL from which we can download the data in <code>.bufr</code> format?</p> <p>Question</p> <p>Find the latest message received on the following topic:</p> <p><code>cache/a/wis2/mwi/malawi_wmo_demo/data/core/weather/surface-based-observations/synop</code></p> <p>What is the URL we can use to download the data?  What is the difference between this URL and the URL in the previous question?</p> <p>Question</p> <p>How does the WIS2 message define the location where the data was observed?  And how you can determine the time that the data was published?</p> <p>Note</p> <p>MQTT Explorer is a helpful tool to review the topic structure for a given MQTT broker and visually work with the MQTT protocol.  There exist many MQTT client and server software.  To work with MQTT programatically (for example, in Python), paho-mqtt can be used to connect to an MQTT broker and process incoming messages.</p>"},{"location":"practical-sessions/connecting-to-mqtt/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>Congratulations!  In this practical session, you learned:</p> <ul> <li>how to subscribe to the WIS2 Global Broker from M\u00e9t\u00e9o-France using MQTT Explorer</li> <li>the WIS2 topic structure</li> <li>the WIS2 notification message structure</li> <li>the difference between Global Broker messages published on the <code>origin</code> and <code>cache</code> topics</li> </ul>"},{"location":"practical-sessions/converting-csv-data-to-bufr/","title":"Converting CSV data to BUFR","text":""},{"location":"practical-sessions/converting-csv-data-to-bufr/#introduction","title":"Introduction","text":"<p>CSV data is a commonly used format for recording tabular data.  <code>csv2bufr</code> is a tool to help convert CSV to BUFR data.</p> <p>In this session you will learn to create BUFR data from CSV, using custom and flexible configuration (mappings) in support of meeting WMO GBON requirements.</p>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#preparation","title":"Preparation","text":"<p>Note</p> <p>Ensure that you are logged into yoru student VM.</p> <p>Navigate to the <code>excercise-materials</code> directory and launch the csv2bufr image into a Docker container:</p> <pre><code>cd ~/exercise-materials/\ndocker run -it -v csv2bufr-exercises:/exercises wmoim/csv2bufr\n</code></pre> <p>Note</p> <p>The additional flag <code>-v csv2bufr-exercises:/exercises</code> ensures that the directory 'csv2bufr-exercises' on your student VM is accessible as '/exercises' inside your container.</p>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#csv2bufr-primer","title":"csv2bufr primer","text":"<p>Below are essential <code>csv2bufr</code> commands and configurations:</p>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#mappings-create","title":"mappings Create","text":"<p>The <code>mappings create</code> command creates an empty BUFR mapping template JSON file, which maps CSV column headers to their corresponding ecCodes element:</p> <pre><code>csv2bufr mappings create &lt;BUFR descriptors&gt; --output &lt;output_dir&gt;\n</code></pre> <p>For more information, see the following [example](https://csv2bufr.readthedocs.io/en/latest/example.html#creating-a-new-mapping-file].</p>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#data-transform","title":"data transform","text":"<p>The <code>data transform</code> command converts a CSV file to BUFR format:</p> <pre><code>csv2bufr data transform --bufr-template &lt;my_template.json&gt; --output-dir &lt;./my_folder&gt; &lt;my_data.csv&gt;\n</code></pre>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#eccodes-bufr-refresher","title":"ecCodes BUFR refresher","text":""},{"location":"practical-sessions/converting-csv-data-to-bufr/#bufr_dump","title":"bufr_dump","text":"<p>The <code>bufr_dump</code> function will allow you to inspect the BUFR files created from the conversion.  It has numerous options;, the following will be most applicable to the exercises:</p> <pre><code>bufr_dump -p &lt;my_bufr.bufr4&gt;\n</code></pre> <p>This will display the content of your BUFR on screen.  If you are interested in the values taken by a variable in particular, use the <code>grep</code> command:</p> <pre><code>bufr_dump -p &lt;my_bufr.bufr4&gt; | grep -i temperature\n</code></pre> <p>This will display the variables related to temperature in your BUFR data.  If you want to do this for multiple types of variables, filter the output using a pipe (<code>|</code>):</p> <pre><code>bufr_dump -p &lt;my_bufr.bufr4&gt; | grep -i 'temperature|wind'\n</code></pre>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#inspecting-csv-data-and-bufr-conversion","title":"Inspecting CSV data and BUFR conversion","text":"<p>Navigate to the <code>ex_1</code> directory and create a mapping file:</p> <pre><code>cd ex_1\nvi my-mapping.json\n</code></pre> <p>Note</p> <p>csv2bufr mappings files have no set file extension, however it recommended to use <code>json</code>.</p> <p>Using the ecCodes WMO element table page, create a mapping file of the following variables:</p> <ul> <li>WIGOS Station Identifier (series, issuer, issue number, local identifier)</li> <li>Date (year, month, day)</li> <li>Time (hour, minute)</li> <li>Location (latitude, longitude)</li> <li>Barometer height above sea level</li> <li>Station level pressure</li> <li>Air temperature</li> <li>Relative humidity</li> </ul> <p>Open the mapping file you have just created and remove any unused elements.</p> <p>Tip</p> <p>Look for and delete the elements which have <code>\"value\": \"\"</code> (you will notice these elements do not directly correspond to any columns in the CSV file).</p> <p>Use the <code>csv2bufr</code> <code>data transform</code> command to convert the file <code>ex_1.csv</code> to BUFR format.</p> <p>Tip</p> <p>See the csv2bufr primer section.</p> <p>Use BUFR Dump to find the latitude and longitude value stored in the output BUFR file. Verify these values using the CSV file.</p> <p>Tip</p> <p>See the BUFR primer section.</p> <p>Navigate to the <code>ex_2</code> directory:</p> <pre><code>cd ../ex_2\n</code></pre> <p>Repeat the previous steps, replacing the following elements with their respective BUFR sequences (which have the form 3XXYYY):</p> <ul> <li>WIGOS Station Identifier (series, issuer, issue number, local identifier)</li> <li>Date (year, month, day)</li> <li>Time (hour, minute)</li> <li>Location (latitude, longitude)</li> </ul> <p>The <code>BUFR_TableD_en.csv</code> file from the <code>BUFR_tables</code> directory contains the defined BUFR sequences as per the official WMO BUFR code tables.</p> <p>The first few columns of this file are as follows (important columns are in bold):</p> <ul> <li>BUFR category (numeric)</li> <li>BUFR category (name)</li> <li>BUFR sequence number</li> <li>BUFR sequence name</li> <li>BUFR sequence subtitle</li> <li>Included BUFR element number</li> <li>Included BUFR element name</li> </ul> <p>A given seqeunce will appear multiple times, once for each BUFR element it contains.</p> <p>Tip</p> <p>Search for the corresponding 6 digit codes found in the previous exercise, and find the corresponding sequence in the 3rd column. For example, the BUFR elements 005002 (Latitude) and 006002 (Longitude) can be replaced with sequence 301023 (Latitude/longitude (coarse accuracy)).</p> <p>Navigate to the <code>ex_3</code> directory, and inspect file <code>ex_3.csv</code>.  Compare this file to <code>ex_2.csv</code>:</p> <pre><code>cd ../ex_3\nmore ex_3.csv\nmore ex_2.csv\n</code></pre> <p>You should notice that the data is the same, however the column names are different.  With this in mind, create a mapping template file for the <code>ex_3.csv</code> file, deleting the redundant elements, and changinge the <code>\"value\"</code> item to correctly correspond to each column in <code>ex_3.csv</code>. <pre><code>my-mapping-ex_3.json\n</code></pre></p> <p>Tip</p> <p>In the first column, <code>\"eccodes_key\": \"#1#wigosIdentifierSeries\"</code> should now be paired with <code>\"value\": \"data:wigos_identifier_series\"</code>.</p> <p>Use the csv2bufr <code>data transform</code> function to convert <code>ex_3.csv</code> to BUFR format.</p> <p>Check that the data stored in the output BUFR is the same as that in the CSV that is was converted from.</p> <p>Navigate to the <code>ex_4</code> directory:</p> <pre><code>cd ../ex_4\n</code></pre> <p>Here, you are free to either work with your own synoptic CSV data, or use the file <code>ex_4_hourly.csv</code>.</p> <p>Noting that a SYNOP report cannot contain the WIGOS station identifier, creating a mappings template which contains the mappings for both the WIGOS station identifier and the hourly synoptic data.</p> <p>Delete all elements in the mapping template that are not present in the CSV data (you should expect to delete most of the file), and edit element names appropriately.</p> <p>Note</p> <p>Make sure that <code>number_header_rows</code> and <code>column_names_row</code> are correct.</p> <ol> <li>Convert the CSV data data to BUFR format.</li> </ol> <p>Note</p> <p>The below steps are optional as time permits:</p> <p>Navigate to the <code>ex_5</code> directory and open the file <code>ex_5.csv</code>::</p> <pre><code>cd ../ex_5\nvi ex_5.csv\n</code></pre> <p>This file contains the same data and column names as <code>ex_2.csv</code>, but uses different units:</p> <ul> <li><code>heightOfBarometerAboveMeanSeaLevel</code> is given in $\\text{cm}$</li> <li><code>nonCoordinatePressure</code> is given in $\\text{hPa}$</li> <li><code>airTemperature</code> is given in $^{\\circ}\\text{C}$</li> </ul> <p>Using the ecCodes WMO element table page, find the correct units for these three variables.</p> <p>Find the scale ($x$, for a multiplication by $10^x$) and offset (addition of a constant $c$) required for each of these conversions.</p> <p>Tip</p> <p>As $1\\text{cm} = 1\\text{m}\\times 10^{-2}$, the first conversion requires a scale of $x=-2$ and an offset of $c=0$.</p> <ol> <li>Open the mapping file <code>mapping_5.json</code>:</li> </ol> <pre><code>vi mapping_5.json\n</code></pre> <p>This the same mapping file as you generated and modified a couple of exercises ago.  Using your answers in the previous question, convert the units using the <code>scale</code> and <code>offset</code> keys.</p> <p>Convert the file <code>ex_5.csv</code> to BUFR format.</p> <p>Navigate to the <code>ex_6</code> directory and open the file <code>ex_6.csv</code>:</p> <pre><code>cd ../ex_6\nvi ex_6.csv\n</code></pre> <p>Question</p> <p>Notice that this time the <code>relative_humidity</code> column contains an incorrect value.  Why is this value incorrect?</p> <p>Tip</p> <p>Think of valid minimum and maximum values for relative humidity.</p> <p>By adjusting the <code>valid_min</code> and <code>valid_max</code> keys of the <code>relativeHumidity</code> element in the mapping file <code>mapping_6.json</code>, enforce a quality control measure which prevents this value from being written to BUFR.</p> <p>Add more valid minimum and maximum values to the mappings file according to your own preference.</p> <p>Note</p> <p>The minimum and maximum values must have the same units as your original input data, not the converted values discussed in the previous exercise.</p> <p>Convert the file <code>ex_6.csv</code> to BUFR format, and use <code>bufr_dump</code> to verify that this variable has no value in the resulting BUFR.</p>"},{"location":"practical-sessions/converting-csv-data-to-bufr/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned:</p> <ul> <li>the basic usage of <code>csv2bufr</code></li> <li>how to create and update a simple csv2bufr mapping file for a variety of scenarios, including for GBON requirements, unit conversion, and quality control/range checking</li> <li>how to <code>csv2bufr</code> on a test data file and convert to BUFR format</li> <li>how to lookup the BUFR element number for a parameter to be encoded</li> <li>how to encode BUFR data for the example input data and inspect the resulting output data</li> <li>about the sequence for hourly climate data</li> <li>about the BUFR Manual on Codes requirements on the units of variables, e.g. Celsius -&gt; Kelvin.</li> </ul>"},{"location":"practical-sessions/converting-synop-data-to-bufr/","title":"Converting SYNOP data to BUFR","text":""},{"location":"practical-sessions/converting-synop-data-to-bufr/#introduction","title":"Introduction","text":"<p>Surface synoptic observations (SYNOP) data are used to report weather observations from surface stations (manned or automated).  synop2bufr is a tool to help convert SYNOP to BUFR data.  ecCodes is a package to reading and writing GRIB and BUFR formats.</p> <p>In this session you will learn about converting a SYNOP report into the WMO BUFR format using the abovementioned tools, as well as the relationship between SYNOP reports and BUFR messages.</p>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#preparation","title":"Preparation","text":"<p>Navigate to the <code>excercise-materials</code> directory and launch the synop2bufr image into a Docker container:</p> <pre><code>cd exercise-materials\ndocker run -it -v csv2bufr-exercises:/exercises wmoim/synop2bufr\n</code></pre> <p>Note</p> <p>Notice the volume mapping from your local directory to the container.</p> <p>Tip</p> <p>See the Docker cheatsheet to learn about additional Docker commands</p>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#synop2bufr-primer","title":"synop2bufr primer","text":"<p>Below are essential <code>synop2bufr</code> commands and configurations:</p>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#transform","title":"transform","text":"<p>The <code>transform</code> function converts a SYNOP message to BUFR:</p> <pre><code>synop2bufr transform --metadata my_file.csv --output-dir ./my_folder --year message_year --month message_month my_SYNOP.txt\n</code></pre> <p>Note that if the metadata, output direction, year and month options are not specified, they will assume their default values:</p> Option Default --metadata metadata.csv --output-dir The current working directory. --year The current year. --month The current month. <p>In the examples, the year and month are not given, so feel free to specify a date yourself or use the default values.</p>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#eccodes-primer","title":"ecCodes primer","text":"<p>ecCodes provides both command line tools and can be embedded in your own applications.  Below are some useful command line utilities to work with BUFR data.</p>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#bufr_dump","title":"bufr_dump","text":"<p>The <code>bufr_dump</code> command is a generic BUFR information tool.  It has many options, but the following will be the most applicable to the exercises:</p> <pre><code>bufr_dump -p my_bufr.bufr4\n</code></pre> <p>This will display BUFR content to your screen.  If you are interested in the values taken by a variable in particular, use the <code>grep</code> command:</p> <pre><code>bufr_dump -p my_bufr.bufr4 |grep -i temperature\n</code></pre> <p>This will display variables related to temperature in your BUFR data. If you want to do this for multiple types of variables, filter the output using a pipe (<code>|</code>):</p> <pre><code>bufr_dump -p my_bufr.bufr4 | grep -i 'temperature|wind'\n</code></pre>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#inspecting-synop-data-and-bufr-conversion","title":"Inspecting SYNOP data and BUFR conversion","text":"<p>To begin with the exercises, login to your VM, and start the synop2bufr container with the following command:</p> <pre><code>docker run -it -v synop2bufr-exercises:/exercises synop2bufr\n</code></pre> <p>Note</p> <p>Ensure that you are still logged into your student VM</p> <p>Navigate to the <code>ex_1</code> directory and inspect a SYNOP message:</p> <pre><code>cd ex_1\nmore message.txt\n</code></pre> <p>Question</p> <p>How many SYNOP reports are in this file?</p> <p>Inspect the station list:</p> <pre><code>more station_list.csv\n</code></pre> <p>Question</p> <p>How many stations are listed in the station list?</p> <p>Convert <code>message.txt</code> to BUFR format.</p> <p>Tip</p> <p>See the synop2bufr primer section.</p> <p>Note</p> <p>BUFR files have no set file extension, however it recommended to use <code>bufr4</code>.</p> <p>Inspect the resulting BUFR data and compare the latitude and longitude values to those in the station list.</p> <p>Tip</p> <p>See the ecCodes primer section.</p> <p>Navigate to the <code>ex_2</code> directory and inspect another SYNOP message:</p> <pre><code>cd ../ex_2\nmore message.txt\n</code></pre> <p>Question</p> <p>How many SYNOP reports are in this file?</p> <p>Inspect the station list:</p> <pre><code>more station_list.csv\n</code></pre> <p>Question</p> <p>How many stations are listed in the station list?</p> <p>Convert <code>message.txt</code> to BUFR format.</p> <p>Question</p> <p>Based on the results of the exercises in this and the previous exercise, how would you predict the number of resulting BUFR files based upon the number of SYNOP reports and stations listed in the station metadata file?</p> <p>Use BUFR Dump to check each of the output BUFR files contain different WIGOS metadata.</p> <p>Navigate to the <code>ex_3</code> directory and inspect the SYNOP message:</p> <pre><code>cd ../ex_3\nmore message.txt\n</code></pre> <p>This SYNOP message only contains one longer report with more sections.</p> <p>Inspect the station list:</p> <pre><code>more station_list.csv\n</code></pre> <p>Question</p> <p>Is it problematic that this file contains more stations than there are reports in the SYNOP message?</p> <p>Note</p> <p>The station list file is simply metadata for <code>synop2bufr</code> to provide further information in processing a SYNOP message.</p> <p>Convert <code>message.txt</code> to BUFR format.</p> <p>Use BUFR Dump to find the following:</p> <ul> <li>Air temperature (K) of the report</li> <li>Total cloud cover (%) of the report</li> <li>Total period of sunshine (mins) of the report</li> <li>Wind speed (m/s) of the report</li> </ul> <p>Navigate to the <code>ex_4</code> directory and inspect the SYNOP message:</p> <pre><code>cd ../ex_4\nmore message_incorrect.txt\n</code></pre> <p>Question</p> <p>What is incorrect about this SYNOP file?</p> <p>Convert <code>message_incorrect.txt</code> using <code>station_list.csv</code></p> <p>Question</p> <p>What problem(s) did you encounter with this conversion?</p> <p>Navigate to the <code>ex_5</code> directory and inspect the SYNOP message:</p> <pre><code>cd ../ex_5\nmore message.txt\n</code></pre> <p>Inspect the station list:</p> <pre><code>more station_list_incorrect.csv\n</code></pre> <p>Question</p> <p>What is missing in the station list?</p> <p>Convert <code>message.txt</code> to BUFR format.</p> <p>Question</p> <p>What problem(s) did you encounter with this conversion?  Were there any message(s) was displayed?</p> <p>Considering the error presented, justify the number of BUFR files produced.</p>"},{"location":"practical-sessions/converting-synop-data-to-bufr/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned:</p> <ul> <li>the principles of SYNOP data reporting</li> <li>how to use <code>synop2bufr</code> to convert SYNOP data to BUFR format</li> <li>how to use <code>bufr_dump</code> to inspect the content of BUFR data</li> </ul>"},{"location":"practical-sessions/data-ingest-and-monitoring/","title":"Data ingest and monitoring","text":"<p>In this session you will learn various ways to ingest data into your wis2box and learn how you can monitor if your data is being ingested without errors.</p> <p>Note that the starting point for wis2box workflow is the MinIO container publishing a message on the <code>wisbox-storage/#</code> topic on the local broker.</p>"},{"location":"practical-sessions/data-ingest-and-monitoring/#preparation","title":"Preparation","text":"<p>Note</p> <p>Before starting please login to your student-VM and ensure your wis2box is started and all services are up:</p> <pre><code>python3 wis2box-ctl.py start\npython3 wis2box-ctl.py status\n</code></pre>"},{"location":"practical-sessions/downloading-data-from-wis2/","title":"Downloading data from WIS2","text":""},{"location":"practical-sessions/installing-wis2box-with-test-data/","title":"Installing wis2box with test data","text":""},{"location":"practical-sessions/installing-wis2box-with-test-data/#introduction","title":"Introduction","text":"<p>In this session you will learn how to install wis2box on your student VM and get familiar with the runtime configuration steps and web interfaces. You will also use predefined configuration and sample data to allow for review of the services provided by your wis2box.</p>"},{"location":"practical-sessions/installing-wis2box-with-test-data/#access-your-wis2box-setup","title":"Access your wis2box setup","text":"<p>Login to your designated VM with your username and password.</p> <p>Your home directory should already contain the exercise materials you downloaded earlier as part of the Accessing your student VM session.</p> <p>Go into the directory containing the wis2box training setup:</p> <pre><code>cd ~/exercise-materials/wis2box-setup\n</code></pre> <p>Note</p> <p>You can always find the latest 'wis2box-setup' archive at https://github.com/wmo-im/wis2box/releases</p> <p>The contents of the 'wis2box-setup' directory are similar to that you will find when downloading and extracting <code>wis2box-setup-*.zip</code> from the official wis2box download page.</p>"},{"location":"practical-sessions/installing-wis2box-with-test-data/#review-and-setup-environment-variables-in-devenv","title":"Review and setup environment variables in <code>dev.env</code>","text":"<p>Copy <code>test.env</code> to <code>dev.env</code>:</p> <pre><code>cp test.env dev.env\n</code></pre> <p>Review the contents of <code>dev.env</code>.</p> <pre><code>cat dev.env\n</code></pre> <p>Note</p> <p><code>dev.env</code> is a required file always used by wis2box</p> <p>Note</p> <p><code>WIS2BOX_HOST_DATADIR</code> is set to <code>${PWD}/test-data</code>.  This directory will be mapped as <code>/data/wis2box</code> inside the wis2box-management container.</p> <p>Note</p> <p><code>LOGGING_LEVEL</code> is set to <code>INFO</code>.  The <code>LOGGING_LEVEL</code> for a wisbox default installation is <code>WARNING</code>.</p> <p>Question</p> <p>Inspect the content of <code>test-data/data-mappings.yml</code>, what topics are configured in this file?</p> <p>Question</p> <p>Inspect the content of <code>test-data/metadata/station/station_list.csv</code>.  How many stations are defined in this file?</p> <p>Question</p> <p>Inspect the content in the <code>test-data/observations</code> directory.  What is the data format used?  What type of observations are reported?</p> <p>Before starting wis2box, add your student VM host to the VM by editing the <code>dev.env</code> file using a command-line editor (vi/vim/nano):</p> <p>And ensure you dev.env now has the additional environment-variables specifying your VM host:</p> <pre><code>WIS2BOX_URL=http://&lt;your-host&gt;\nWIS2BOX_API_URL=http://&lt;your-host&gt;/oapi\n</code></pre>"},{"location":"practical-sessions/installing-wis2box-with-test-data/#start-wis2box","title":"Start wis2box","text":"<p>start wis2box with the following command:</p> <pre><code>python3 wis2box-ctl.py start\n</code></pre> <p>Wait until the command has completed.</p> <p>Inspect the status with the following command:</p> <pre><code>python3 wis2box-ctl.py status\n</code></pre> <p>Repeat this command until you are sure all services are up and running.</p> <p>Open a web browser and visit the page <code>http://&lt;your-host&gt;</code>.</p> <p>This is the default wis2box web application (running via the wis2box-ui container).  We see that the homepage is empty, given no datasets are setup yet.</p> <p>On your web browser, open a new tab and navigate to the page <code>http://&lt;your-host&gt;/oapi</code>.</p> <p>This is the wis2box API (running via the wis2box-api container).</p> <p>To view collections currently published to the API, navigate to the page <code>http://&lt;your-host&gt;/oapi/collections</code>.</p> <p>Question</p> <p>What collection is currently available?</p> <p>Question</p> <p>How many data notifications have been published?</p> <p>Make sure you can connect to your broker (running via the wis2box-broker container) using MQTT Explorer with the following connection details:</p> <ul> <li>Protocol: mqtt://</li> <li>Host:  <li>Port: 1883</li> <li>Username: wis2box</li> <li>Password: wis2box</li> <li>under 'ADVANCED', subscribe to the topics <code>$SYS</code> and <code>origin/#</code></li> <p>You should see statistics being published by your broker on the <code>$SYS</code> topic. Keep MQTT Explorer running and continue with the runtime configuration steps.</p>"},{"location":"practical-sessions/installing-wis2box-with-test-data/#runtime-configuration-steps-for-wis2box","title":"Runtime configuration steps for wis2box","text":"<p>Login to the wis2box-management container using the following command:</p> <pre><code>python3 wis2box-ctl.py login\n</code></pre> <p>Note</p> <p>This command is equivalent to <code>docker exec -it wis2box-management /bin/bash</code>, meaning that you have entered an interactive shell inside the wis2box-management container.</p> <p>Run the following command to see the environment variables used by your wis2box:</p> <pre><code>wis2box environment show\n</code></pre> <p>Note the variables you have set for <code>WIS2BOX_HOST_DATADIR</code>, <code>WIS2BOX_URL</code> and <code>WIS2BOX_API_URL</code>.</p> <p>Run the following command to see the content of <code>/data/wis2box</code> directory inside the wis2box-management container:</p> <pre><code>ls /data/wis2box/\n</code></pre> <p>Note</p> <p>The content of <code>/data/wis2box</code> matches that of the directory defined by <code>$WIS2BOX_HOST_DATADIR</code> on your VM.</p> <p>Run the following command to add the test dataset:</p> <pre><code>wis2box data add-collection /data/wis2box/mwi-surface-weather-observations.yml\n</code></pre> <ul> <li>Go back to your web browser and refresh the <code>http://&lt;your-host&gt;/oapi/collections</code> page.  Inspect the new collection.</li> </ul> <p>Run the following command to publish discovery metadata for the test dataset:</p> <pre><code>wis2box metadata discovery publish /data/wis2box/mwi-surface-weather-observations.yml\n</code></pre> <p>Go back to your web browser and refresh the <code>http://&lt;your-host&gt;/oapi/collections</code> page.</p> <p>Question</p> <p>What new collection is now available?</p> <p>Switch back to MQTT Explorer and find the discovery metadata message that was published by your broker.</p> <p>Question</p> <p>What is the topic is used to publish the discovery metadata message?</p> <p>Run the following command to publish the station metadata in <code>test-data/metadata/station/station_list.csv</code>:</p> <pre><code>wis2box metadata station publish-collection\n</code></pre> <p>Go back to your web browser and refresh the <code>http://&lt;your-host&gt;/oapi/collections</code> page. Inspect the collection called \"Stations\" and confirm that all stations from <code>test-data/station/station_list.csv</code> are now visible.</p>"},{"location":"practical-sessions/installing-wis2box-with-test-data/#ingesting-data","title":"Ingesting data","text":"<p>Make you are logged in to the wis2box-management container (<code>python3 wis2box-ctl.py login</code>) and execute the following command:</p> <pre><code>wis2box data ingest -th mwi.mwi_met_centre.data.core.weather.surface-based-observations.synop -p /data/wis2box/observations/malawi/\n</code></pre> <p>Ensure that the command completes successfully without errors.</p> <p>Review the collections on your API <code>http://&lt;your-host&gt;/oapi/collections</code> page.</p> <p>Question</p> <p>What changes do you observe?</p> <p>Click the the \"EXPLORE\" option on <code>http://&lt;your-host&gt;</code>.</p> <p>Question</p> <p>What changes do you observe?</p> <p>Check your wis2box workflow monitoring on <code>http://&lt;your-host&gt;:3000</code> (powered by the grafana container).</p> <p>Question</p> <p>Can you identify any errors?</p> <p>View the messages that have been published on your local broker in MQTT Explorer.</p> <p>Question</p> <p>What is the topic used to publish messages advertising new data? What is the URL to download the data?</p>"},{"location":"practical-sessions/installing-wis2box-with-test-data/#conclusion","title":"Conclusion","text":"<p>Congratulations!</p> <p>In this practical session, you learned how to:</p> <ul> <li>install wis2box on your personal VM</li> <li>setup wis2box with the pre-defined configuration</li> <li>start wis2box and check the status of its components</li> <li>run the various wis2box runtime configuration steps</li> <li>access the wis2box web application, API, and Grafana dashboard</li> </ul>"}]}