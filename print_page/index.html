
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://wmo-im.github.io/wis2box-training/print_page/">
      
      
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>Print Site - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
    <script>__md_scope=new URL("/wis2box-training/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wmo-im/wis2box-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wmo-im/wis2box-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../overviews/" class="md-nav__link">
        Overviews
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Practical sessions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Practical sessions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/connecting-to-mqtt/" class="md-nav__link">
        Connecting to WIS2 over MQTT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/access-your-student-vm/" class="md-nav__link">
        Accessing your student VM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/installing-wis2box-with-test-data/" class="md-nav__link">
        Installing wis2box with test data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/converting-synop-data-to-bufr/" class="md-nav__link">
        Converting SYNOP data to BUFR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/converting-csv-data-to-bufr/" class="md-nav__link">
        Converting CSV data to BUFR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/configuring-data-mappings/" class="md-nav__link">
        Configuring data mappings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/configuring-wis2-discovery-metadata/" class="md-nav__link">
        Configuring WIS2 discovery metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/configuring-station-metadata/" class="md-nav__link">
        Configuring station metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/data-ingest-and-monitoring/" class="md-nav__link">
        Data ingest and monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practical-sessions/downloading-data-from-wis2/" class="md-nav__link">
        Downloading data from WIS2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Cheatsheets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Cheatsheets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheets/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheets/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheets/wis2box/" class="md-nav__link">
        WIS2 in a box
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overviews" class="md-nav__link">
    2. Overviews
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-practical-sessions" class="md-nav__link">
    I. Practical sessions
  </a>
  
    <nav class="md-nav" aria-label="I. Practical sessions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#practical-sessions-connecting-to-mqtt" class="md-nav__link">
    3. Connecting to WIS2 over MQTT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-access-your-student-vm" class="md-nav__link">
    4. Accessing your student VM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-installing-wis2box-with-test-data" class="md-nav__link">
    5. Installing wis2box with test data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-converting-synop-data-to-bufr" class="md-nav__link">
    6. Converting SYNOP data to BUFR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-converting-csv-data-to-bufr" class="md-nav__link">
    7. Converting CSV data to BUFR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-configuring-data-mappings" class="md-nav__link">
    8. Configuring data mappings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-configuring-wis2-discovery-metadata" class="md-nav__link">
    9. Configuring WIS2 discovery metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-configuring-station-metadata" class="md-nav__link">
    10. Configuring station metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-data-ingest-and-monitoring" class="md-nav__link">
    11. Data ingest and monitoring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practical-sessions-downloading-data-from-wis2" class="md-nav__link">
    12. Downloading data from WIS2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-cheatsheets" class="md-nav__link">
    II. Cheatsheets
  </a>
  
    <nav class="md-nav" aria-label="II. Cheatsheets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cheatsheets-linux" class="md-nav__link">
    13. Linux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheatsheets-docker" class="md-nav__link">
    14. Docker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheatsheets-wis2box" class="md-nav__link">
    15. WIS2 in a box
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><p><img alt="WMO logo" src="../assets/img/wmo-logo.png" width="200"></p>
<h1 id="index-wis2-in-a-box-training">WIS2 in a box training</h1>
<p>WIS2 in a box (<a href="https://docs.wis2box.wis.wmo.int">wis2box</a>) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.</p>
<p>This training provides step-by-step explanations of various aspects of the wis2box project as well as a number of exercises
to help you publish and download data from WIS2.  The training is provided in the form of overview presentations as well as
hands-on practical exercises.</p>
<p>Participants will be able to work with sample test data and metadata, as well as integrate their own data and metadata.</p>
<p>This training covers a wide range of topics (install/setup/configuration, publishing/downloading data, etc.).</p>
<h2 id="index-navigation">Navigation</h2>
<p>The left hand navigation provides a table of contents for the entire training.</p>
<p>The right hand navigation provides a table of concents for a specific page.</p>
<h2 id="index-prerequisites">Prerequisites</h2>
<h3 id="index-knowledge">Knowledge</h3>
<ul>
<li>Basic Linux commands (see the <a href="#cheatsheets-linux">cheatsheet</a>)</li>
<li>Basic knowledge of networking and Internet protocols</li>
</ul>
<h3 id="index-software">Software</h3>
<p>This training requires the following tools:</p>
<ul>
<li>An instance running Ubuntu OS with Docker and docker-composer (see <a href="https://wmoomm-my.sharepoint.com/:p:/g/personal/tproescholdt_wmo_int/EQoxn5WS7kBAoe5iNyfeteABAjw67YZBvEWM92NlWUu5wQ?e=gtgm13">training-environment</a>)</li>
<li>SSH client to access your instance</li>
<li>MQTT Explorer on your local machine</li>
</ul>
<h2 id="index-goals-and-learning-outcomes">Goals and learning outcomes</h2>
<p>The goals of this training are to become familiar with the following:</p>
<ul>
<li>WIS2 concepts and core functions and components</li>
<li>Required and optional functions of a WIS2 Node</li>
<li>WIS2 in a box architecture and environment</li>
<li>data and metadata formats used in WIS2 for discovery and access</li>
<li>wis2box core functions:<ul>
<li>sending data</li>
<li>registering as a WIS2 Node</li>
<li>downloading data from broker</li>
<li>monitoring operations</li>
</ul>
</li>
</ul>
<h2 id="index-conventions">Conventions</h2>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>A section marked like this invites you to answer a question.</p>
</div>
<p>Also you will notice tips and notes sections within the text:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Tips share help on how to best achieve tasks.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notes provide additional information on the topic covered by the practical session, as well as how to best achieve tasks.</p>
</div>
<p>Examples are indicated as follows:</p>
<p>Configuration
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">my-collection-defined-in-yaml</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my title defined as a yaml attribute named title</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my description as a yaml attribute named description</span>
</code></pre></div></td></tr></table></div></p>
<p>Snippets which need to be typed in a on a terminal/console are indicated as:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Hello world&#39;</span>
</code></pre></div>
<h2 id="index-training-location-and-materials">Training location and materials</h2>
<p>This training is always provided live at <a href="https://training.wis2box.wis.wmo.int">https://training.wis2box.wis.wmo.int</a>.</p>
<p>The training contents, wiki and issue tracker are managed on GitHub at <a href="https://github.com/wmo-im/wis2box-training">https://github.com/wmo-im/wis2box-training</a>.</p>
<h2 id="index-printing-the-material">Printing the material</h2>
<p>This training can be exported to PDF.  To save or print this training material, go to the <a href="#print_page">print page</a>, and select
File &gt; Print &gt; Save as PDF.</p>
<h2 id="index-exercise-materials">Exercise materials</h2>
<p>Exercise materials can be downloaded from the <a href="https://wmo-im.github.io/wis2box-training/exercise-materials.zip">exercise-materials.zip</a> zipfile.</p>
<h2 id="index-support">Support</h2>
<p>For issues/bugs/suggestions or improvements/contributions to this training, please use the <a href="https://github.com/wmo-im/wis2box-training/issues">GitHub issue tracker</a>.</p>
<p>All wis2box bugs, enhancements and issues can be reported on <a href="https://github.com/wmo-im/wis2box/issues">GitHub</a>.</p>
<p>For additional support of questions, please contact wis@wmo.int.</p>
<p>As always, wis2box core documentation can always be found at <a href="https://docs.wis2box.wis.wmo.int">https://docs.wis2box.wis.wmo.int</a>.</p>
<p>Contributions are always encouraged and welcome!</p></section><section class="print-page" id="overviews"><h1 id="overviews-overviews">Overviews</h1>
<p>The following presentations provide conceptual overviews presented during the training:</p>
<ul>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/WIS2-Pilot-phase-Namibia.pptx">WIS2-pilot-phase</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/WIS+2.0+Architecture.pptx">WIS 2.0 Architecture</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/wis2box-training-day1-introduction.pptx">Introducing WIS2 in a box</a></li>
<li><a href="#overviews-none">WIS 2 box case studies (Malawi)</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/WIS%202%20box%20training%20environment-2.pptx">Training environment</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/WMO_BUFR_in_a_nutshell.pptx">BUFR in a nutshell</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/WMO_BUFR_with_ecCodes.pptx">BUFR and ecCodes</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/wis2box-training-day2-project-install.pptx">WIS2 in a box project and installation</a></li>
<li><a href="https://wmo-teams.atlassian.net/wiki/download/attachments/377061379/wis2box-training-day3-architecture.pptx">WIS2 in a box architecture</a></li>
<li><a href="#overviews-none">Register your WIS2 node in WIS2</a></li>
<li><a href="#overviews-none">Sharing a new station with WMO</a></li>
</ul></section>
                        <h1 class='nav-section-title' id='section-practical-sessions'>
                            Practical sessions <a class='headerlink' href='#section-practical-sessions' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="practical-sessions-connecting-to-mqtt"><h1 id="practical-sessions-connecting-to-mqtt-connecting-to-wis2-over-mqtt">Connecting to WIS2 over MQTT</h1>
<h2 id="practical-sessions-connecting-to-mqtt-introduction">Introduction</h2>
<p>WIS2 uses the MQTT protocol to advertise the availability of weather/climate/water data. The WIS2 Global Broker subscribes to all WIS2 Nodes in the network and republishes the messages it receives. The Global Cache subscribes to the Global Broker, downloads the data in the message and then republishes the message on the <code>cache</code> topic with a new URL.  The Global Discovery Catalogue publishes discovery metadata from the Broker and provides a search API.</p>
<p>As part of the WIS2 Pilot Phase in 2023, Météo-France is running a Global Broker.  In this practical session you will learn how to use the MQTT Explorer tool to review the topics available on this Global Broker and be able to display WIS2 notification messages.</p>
<h2 id="practical-sessions-connecting-to-mqtt-using-mqtt-explorer-to-connect-to-the-global-broker">Using MQTT Explorer to connect to the Global Broker</h2>
<p>One way to view messages published by this Global Broker is using the MQTT Explorer which can be downloaded from the <a href="https://mqtt-explorer.com">MQTT Explorer website</a>.</p>
<p>Open MQTT Explorer and add a new connection as follows:</p>
<p><img alt="mqtt-explorer-global-broker-connection" src="../assets/img/mqtt-explorer-global-broker-connection.png" width="600"></p>
<p>Click on the 'ADVANCED' button and add the following topics to subscribe to:</p>
<p><img alt="mqtt-explorer-global-broker-advanced" src="../assets/img/mqtt-explorer-global-broker-advanced.png" width="600"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When setting up MQTT subscriptions you can use the following wildcards:</p>
<ul>
<li><strong>Single-level (+)</strong>: a single-level wildcard replaces one topic level</li>
<li><strong>Multi-level (#)</strong>: a multi-level wildcard replaces multiple topic levels</li>
</ul>
</div>
<p>Click 'BACK', then 'SAVE' to save your connection and subscription details.  Then click 'CONNECT':</p>
<p>At this point, the following should appear in the MQTT Explorer session:</p>
<p><img alt="mqtt-explorer-global-broker-topics" src="../assets/img/mqtt-explorer-global-broker-topics.png" width="600"></p>
<p>You are now ready to start exploring the WIS2 topics and message structure and answer the following questions:</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How can we distinguish the originating country providing the data?  How many countries are sharing data?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Find the latest message received in the following topic:</p>
<p><code>origin/a/wis2/mwi/malawi_wmo_demo/data/core/weather/surface-based-observations/synop</code></p>
<p>What is the the value of the URL from which we can download the data in <code>.bufr</code> format?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Find the latest message received on the following topic:</p>
<p><code>cache/a/wis2/mwi/malawi_wmo_demo/data/core/weather/surface-based-observations/synop</code></p>
<p>What is the URL we can use to download the data?  What is the difference between this URL and the URL in the previous question?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How does the WIS2 message define the location where the data was observed?  And how you can determine the time that the data was published?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MQTT Explorer is a helpful tool to review the topic structure for a given MQTT broker and visually work with the MQTT protocol.  There exist
many MQTT client and server software.  To work with MQTT programatically (for example, in Python), <a href="https://pypi.org/project/paho-mqtt/">paho-mqtt</a>
can be used to connect to an MQTT broker and process incoming messages.</p>
</div>
<h2 id="practical-sessions-connecting-to-mqtt-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>Congratulations!  In this practical session, you learned:</p>
<ul>
<li>how to subscribe to the WIS2 Global Broker from Météo-France using MQTT Explorer</li>
<li>the WIS2 topic structure</li>
<li>the WIS2 notification message structure</li>
<li>the difference between Global Broker messages published on the <code>origin</code> and <code>cache</code> topics</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-access-your-student-vm"><h1 id="practical-sessions-access-your-student-vm-access-your-student-vm">Access your student VM</h1>
<h2 id="practical-sessions-access-your-student-vm-introduction">Introduction</h2>
<p>In this session you will ensure you can connect to your student VM, check pre-installed software and download the exercise materials.</p>
<p>As part of locally run wis2box training sessions, you can access your personal student VM on the local training network named "WIS2-training".</p>
<p>If you want to run this training outside of a local training session, you can provide your own instance as detailed in the <a href="#overviews">training environment</a> overview.</p>
<h2 id="practical-sessions-access-your-student-vm-connect-to-your-student-vm-on-the-local-training-network">Connect to your student VM on the local training network</h2>
<p>Use the following configuraiton to connect your PC on the local WiFi broadcasted in the room during WIS2 training:</p>
<ul>
<li><strong>SSID: WIS2-training</strong></li>
<li><strong>password: dataismagic!</strong></li>
</ul>
<p>Use an SSH client to connect to your student VM using the following:</p>
<ul>
<li><strong>Host: country-lastname.wis2box.training</strong> (replace with your country and lastname)</li>
<li><strong>Port: 22</strong></li>
<li><strong>Username: lastname</strong> (replace with your lastname)</li>
<li><strong>Password: namibia2023</strong></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Contact a trainer if you are unsure about the hostname or have issues connecting.</p>
</div>
<p>Once connected, please change your password to ensure others cannot access your VM:</p>
<div class="highlight"><pre><span></span><code>limper@student-vm:~$<span class="w"> </span>passwd
Changing<span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>limper.
Current<span class="w"> </span>password:
New<span class="w"> </span>password:
Retype<span class="w"> </span>new<span class="w"> </span>password:
passwd:<span class="w"> </span>password<span class="w"> </span>updated<span class="w"> </span>successfully
</code></pre></div>
<h2 id="practical-sessions-access-your-student-vm-verify-software-versions">Verify software versions</h2>
<p>Your student VM comes with Python, Docker and Docker Compose pre-installed.</p>
<p>Check docker version:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>--version
</code></pre></div>
returns:
<div class="highlight"><pre><span></span><code>Docker<span class="w"> </span>version<span class="w"> </span><span class="m">20</span>.10.17,<span class="w"> </span>build<span class="w"> </span>100c701
</code></pre></div></p>
<p>Check Docker Compose version:
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>--version
</code></pre></div>
returns:
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.29.2,<span class="w"> </span>build<span class="w"> </span>unknown
</code></pre></div></p>
<p>Check Python version:
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>--version
</code></pre></div>
returns:
<div class="highlight"><pre><span></span><code>Python<span class="w"> </span><span class="m">3</span>.8.10
</code></pre></div></p>
<h2 id="practical-sessions-access-your-student-vm-run-docker-hello-world">Run docker 'hello-world'</h2>
<p>In the local training environment, your student account has been added to the <code>docker</code> group to allow you to work with Docker.  You can verify this by running the Docker <code>hello-world</code> image:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>hello-world
</code></pre></div>
<p>This command downloads the <code>hello-world</code> image from the local registry and interactively runs a Docker container for this image.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you get an error it is often an indication that your username does not have the appropriate permissions to access the Docker filesystem.  The user running Docker commands must be added to the <code>docker</code> group in order to run Docker containers.</p>
</div>
<h2 id="practical-sessions-access-your-student-vm-review-docker-system-usage">Review Docker system usage</h2>
<p>Inspect youf local Docker system usage using the command:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>system<span class="w"> </span>df
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What usage can you currently observe for your Docker system?</p>
</div>
<p>Cleanup your Docker system with the command:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>system<span class="w"> </span>prune<span class="w"> </span>-a
</code></pre></div>
<p>Verify Docker system is now clean of any Docker resources:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>system<span class="w"> </span>df
</code></pre></div></p>
<p>should return:
<div class="highlight"><pre><span></span><code>TYPE<span class="w">            </span>TOTAL<span class="w">     </span>ACTIVE<span class="w">    </span>SIZE<span class="w">      </span>RECLAIMABLE
Images<span class="w">          </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span>0B<span class="w">        </span>0B
Containers<span class="w">      </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span>0B<span class="w">        </span>0B
Local<span class="w"> </span>Volumes<span class="w">   </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span>0B<span class="w">        </span>0B
Build<span class="w"> </span>Cache<span class="w">     </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span>0B<span class="w">        </span><span class="m">0</span>
</code></pre></div></p>
<h2 id="practical-sessions-access-your-student-vm-download-the-exercise-materials">Download the exercise materials</h2>
<p>Please download the exercise materials to your local VM and extract the archive with the following commands:</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://wmo-im.github.io/wis2box-training/exercise-materials.zip
unzip<span class="w"> </span>exercise-materials.zip
</code></pre></div>
<p>Inspect the contents of the <code>exercise-materials</code> directory; these are the materials used as part of the training and practical sessions.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>exercise-materials
ls
</code></pre></div>
<p>Return to your previous directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<h2 id="practical-sessions-access-your-student-vm-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned how to:</p>
<ul>
<li>access your student VM over SSH</li>
<li>verify the versions of Python, Docker and Docker Compose on your local student VM</li>
<li>verify that Docker commands can be successfully run</li>
<li>check Docker system resource usage</li>
<li>download, extract and review the exercise materials for this training on your local student VM</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-installing-wis2box-with-test-data"><h1 id="practical-sessions-installing-wis2box-with-test-data-installing-wis2box-with-test-data">Installing wis2box with test data</h1>
<h2 id="practical-sessions-installing-wis2box-with-test-data-introduction">Introduction</h2>
<p>In this session you will learn how to install wis2box on your student VM and get familiar with the runtime configuration steps and web interfaces. You will also use predefined configuration and sample data to allow for review of the services provided by your wis2box.</p>
<h2 id="practical-sessions-installing-wis2box-with-test-data-access-your-wis2box-setup">Access your wis2box setup</h2>
<p>Login to your designated VM with your username and password.</p>
<p>Your home directory should already contain the exercise materials you downloaded earlier as part of the <a href="#practical-sessions-access-your-student-vm">Accessing your student VM</a> session.</p>
<p>Go into the directory containing the wis2box training setup:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/wis2box-setup
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can always find the latest 'wis2box-setup' archive at <a href="https://github.com/wmo-im/wis2box/releases">https://github.com/wmo-im/wis2box/releases</a></p>
<p>The contents of the 'wis2box-setup' directory are similar to that you will find when downloading and extracting <code>wis2box-setup-*.zip</code> from the official wis2box download page.</p>
</div>
<h2 id="practical-sessions-installing-wis2box-with-test-data-review-and-setup-environment-variables-in-devenv">Review and setup environment variables in <code>dev.env</code></h2>
<p>Copy <code>test.env</code> to <code>dev.env</code>:</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>test.env<span class="w"> </span>dev.env
</code></pre></div>
<p>Review the contents of <code>dev.env</code>.</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>dev.env
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>dev.env</code> is a required file always used by wis2box</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>WIS2BOX_HOST_DATADIR</code> is set to <code>${PWD}/test-data</code>.  This directory will be mapped as <code>/data/wis2box</code> inside the <strong>wis2box-management</strong> container.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>LOGGING_LEVEL</code> is set to <code>INFO</code>.  The <code>LOGGING_LEVEL</code> for a wisbox default installation is <code>WARNING</code>.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Inspect the content of <code>test-data/data-mappings.yml</code>, what topics are configured in this file?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Inspect the content of <code>test-data/metadata/station/station_list.csv</code>.  How many stations are defined in this file?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Inspect the content in the <code>test-data/observations</code> directory.  What is the data format used?  What type of observations are reported?</p>
</div>
<p>Before starting wis2box, add your student VM host to the VM by editing the <code>dev.env</code> file using a command-line editor (vi/vim/nano):</p>
<p>And ensure you dev.env now has the additional environment-variables specifying <strong>your</strong> VM host:</p>
<div class="highlight"><pre><span></span><code>WIS2BOX_URL=http://&lt;your-host&gt;
WIS2BOX_API_URL=http://&lt;your-host&gt;/oapi
</code></pre></div>
<h2 id="practical-sessions-installing-wis2box-with-test-data-start-wis2box">Start wis2box</h2>
<p>start wis2box with the following command:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
</code></pre></div>
<p>Wait until the command has completed.</p>
<p>Inspect the status with the following command:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
<p>Repeat this command until you are sure all services are up and running.</p>
<p>Open a web browser and visit the page <code>http://&lt;your-host&gt;</code>.</p>
<p>This is the default wis2box web application (running via the <strong>wis2box-ui</strong> container).  We see that the homepage is empty, given no datasets are setup yet.</p>
<p>On your web browser, open a new tab and navigate to the page <code>http://&lt;your-host&gt;/oapi</code>.</p>
<p>This is the wis2box API (running via the <strong>wis2box-api</strong> container).</p>
<p>To view collections currently published to the API, navigate to the page <code>http://&lt;your-host&gt;/oapi/collections</code>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What collection is currently available?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many data notifications have been published?</p>
</div>
<p>Make sure you can connect to your broker (running via the <strong>wis2box-broker</strong> container) using MQTT Explorer with the following connection details:</p>
<ul>
<li><strong>Protocol: mqtt://</strong></li>
<li><strong>Host: <your-host></strong></li>
<li><strong>Port: 1883</strong></li>
<li><strong>Username: wis2box</strong></li>
<li><strong>Password: wis2box</strong></li>
<li>under 'ADVANCED', subscribe to the topics <code>$SYS</code> and <code>origin/#</code></li>
</ul>
<p>You should see statistics being published by your broker on the <code>$SYS</code> topic. Keep MQTT Explorer running and continue with the runtime configuration steps.</p>
<h2 id="practical-sessions-installing-wis2box-with-test-data-runtime-configuration-steps-for-wis2box">Runtime configuration steps for wis2box</h2>
<p>Login to the <strong>wis2box-management</strong> container using the following command:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This command is equivalent to <code>docker exec -it wis2box-management /bin/bash</code>, meaning that you have entered an interactive shell inside the <strong>wis2box-management</strong> container.</p>
</div>
<p>Run the following command to see the environment variables used by your wis2box:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>environment<span class="w"> </span>show
</code></pre></div>
<p>Note the variables you have set for <code>WIS2BOX_HOST_DATADIR</code>, <code>WIS2BOX_URL</code> and <code>WIS2BOX_API_URL</code>.</p>
<p>Run the following command to see the content of <code>/data/wis2box</code> directory inside the <strong>wis2box-management</strong> container:</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>/data/wis2box/
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The content of <code>/data/wis2box</code> matches that of the directory defined by <code>$WIS2BOX_HOST_DATADIR</code> on your VM.</p>
</div>
<p>Run the following command to add the test dataset:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>add-collection<span class="w"> </span>/data/wis2box/mwi-surface-weather-observations.yml
</code></pre></div>
<ul>
<li>Go back to your web browser and refresh the <code>http://&lt;your-host&gt;/oapi/collections</code> page.  Inspect the new collection.</li>
</ul>
<p>Run the following command to publish discovery metadata for the test dataset:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>metadata<span class="w"> </span>discovery<span class="w"> </span>publish<span class="w"> </span>/data/wis2box/mwi-surface-weather-observations.yml
</code></pre></div>
<p>Go back to your web browser and refresh the <code>http://&lt;your-host&gt;/oapi/collections</code> page.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What new collection is now available?</p>
</div>
<p>Switch back to MQTT Explorer and find the discovery metadata message that was published by your broker.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is the topic is used to publish the discovery metadata message?</p>
</div>
<p>Run the following command to publish the station metadata in <code>test-data/metadata/station/station_list.csv</code>:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>metadata<span class="w"> </span>station<span class="w"> </span>publish-collection
</code></pre></div>
<p>Go back to your web browser and refresh the <code>http://&lt;your-host&gt;/oapi/collections</code> page. Inspect the collection called "Stations" and confirm that all stations from <code>test-data/station/station_list.csv</code> are now visible.</p>
<h2 id="practical-sessions-installing-wis2box-with-test-data-ingesting-data">Ingesting data</h2>
<p>Make you are logged in to the <strong>wis2box-management</strong> container (<code>python3 wis2box-ctl.py login</code>) and execute the following command:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>ingest<span class="w"> </span>-th<span class="w"> </span>mwi.mwi_met_centre.data.core.weather.surface-based-observations.synop<span class="w"> </span>-p<span class="w"> </span>/data/wis2box/observations/malawi/
</code></pre></div>
<p>Ensure that the command completes successfully without errors.</p>
<p>Review the collections on your API <code>http://&lt;your-host&gt;/oapi/collections</code> page.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What changes do you observe?</p>
</div>
<p>Click the the "EXPLORE" option on <code>http://&lt;your-host&gt;</code>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What changes do you observe?</p>
</div>
<p>Check your wis2box workflow monitoring on <code>http://&lt;your-host&gt;:3000</code> (powered by the <strong>grafana</strong> container).</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Can you identify any errors?</p>
</div>
<p>View the messages that have been published on your local broker in MQTT Explorer.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is the topic used to publish messages advertising new data? What is the URL to download the data?</p>
</div>
<h2 id="practical-sessions-installing-wis2box-with-test-data-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned how to:</p>
<ul>
<li>install wis2box on your personal VM</li>
<li>setup wis2box with the pre-defined configuration</li>
<li>start wis2box and check the status of its components</li>
<li>run the various wis2box runtime configuration steps</li>
<li>access the wis2box web application, API, and Grafana dashboard</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-converting-synop-data-to-bufr"><h1 id="practical-sessions-converting-synop-data-to-bufr-converting-synop-data-to-bufr">Converting SYNOP data to BUFR</h1>
<h2 id="practical-sessions-converting-synop-data-to-bufr-introduction">Introduction</h2>
<p>Surface synoptic observations (SYNOP) data are used to report weather observations from surface
stations (manned or automated).  <a href="https://github.com/wmo-im/synop2bufr">synop2bufr</a> is a tool to
help convert SYNOP to BUFR data.  <a href="https://confluence.ecmwf.int/display/ECC/ecCodes+Home">ecCodes</a>
is a package to reading and writing GRIB and BUFR formats.</p>
<p>In this session you will learn about converting a SYNOP report into the WMO BUFR format using the
abovementioned tools, as well as the relationship between SYNOP reports and BUFR messages.</p>
<h2 id="practical-sessions-converting-synop-data-to-bufr-preparation">Preparation</h2>
<p>Navigate to the <code>excercise-materials</code> directory and launch the <strong>synop2bufr</strong> image into a Docker container:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>exercise-materials
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-v<span class="w"> </span>csv2bufr-exercises:/exercises<span class="w"> </span>wmoim/synop2bufr
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice the volume mapping from your local directory to the container.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="#cheatsheets-docker">Docker cheatsheet</a> to learn about additional Docker commands</p>
</div>
<h2 id="practical-sessions-converting-synop-data-to-bufr-synop2bufr-primer">synop2bufr primer</h2>
<p>Below are essential <code>synop2bufr</code> commands and configurations:</p>
<h3 id="practical-sessions-converting-synop-data-to-bufr-transform">transform</h3>
<p>The <code>transform</code> function converts a SYNOP message to BUFR:</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>my_file.csv<span class="w"> </span>--output-dir<span class="w"> </span>./my_folder<span class="w"> </span>--year<span class="w"> </span>message_year<span class="w"> </span>--month<span class="w"> </span>message_month<span class="w"> </span>my_SYNOP.txt
</code></pre></div>
<p>Note that if the metadata, output direction, year and month options are not specified, they will assume their default values:</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>--metadata</td>
<td>metadata.csv</td>
</tr>
<tr>
<td>--output-dir</td>
<td>The current working directory.</td>
</tr>
<tr>
<td>--year</td>
<td>The current year.</td>
</tr>
<tr>
<td>--month</td>
<td>The current month.</td>
</tr>
</tbody>
</table>
<p>In the examples, the year and month are not given, so feel free to specify a date yourself or use the default values.</p>
<h2 id="practical-sessions-converting-synop-data-to-bufr-eccodes-primer">ecCodes primer</h2>
<p>ecCodes provides both command line tools and can be embedded in your own applications.  Below are some useful command
line utilities to work with BUFR data.</p>
<h3 id="practical-sessions-converting-synop-data-to-bufr-bufr_dump">bufr_dump</h3>
<p>The <code>bufr_dump</code> command is a generic BUFR information tool.  It has many options, but the following will be the most applicable to the exercises:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>my_bufr.bufr4
</code></pre></div>
<p>This will display BUFR content to your screen.  If you are interested in the values taken by a variable in particular, use the <code>grep</code> command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>my_bufr.bufr4<span class="w"> </span><span class="p">|</span>grep<span class="w"> </span>-i<span class="w"> </span>temperature
</code></pre></div>
<p>This will display variables related to temperature in your BUFR data. If you want to do this for multiple types of variables, filter the output using a pipe (<code>|</code>):</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>my_bufr.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;temperature|wind&#39;</span>
</code></pre></div>
<h2 id="practical-sessions-converting-synop-data-to-bufr-inspecting-synop-data-and-bufr-conversion">Inspecting SYNOP data and BUFR conversion</h2>
<p>To begin with the exercises, login to your VM, and start the <strong>synop2bufr</strong> container with the following command:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-v<span class="w"> </span>synop2bufr-exercises:/exercises<span class="w"> </span>synop2bufr
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure that you are still logged into your student VM</p>
</div>
<p>Navigate to the <code>ex_1</code> directory and inspect a SYNOP message:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ex_1
more<span class="w"> </span>message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many SYNOP reports are in this file?</p>
</div>
<p>Inspect the station list:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many stations are listed in the station list?</p>
</div>
<p>Convert <code>message.txt</code> to BUFR format.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="#practical-sessions-converting-synop-data-to-bufr-synop2bufr-primer">synop2bufr primer</a> section.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>BUFR files have no set file extension, however it recommended to use <code>bufr4</code>.</p>
</div>
<p>Inspect the resulting BUFR data and compare the latitude and longitude values to those in the station list.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="#practical-sessions-converting-synop-data-to-bufr-eccodes-primer">ecCodes primer</a> section.</p>
</div>
<p>Navigate to the <code>ex_2</code> directory and inspect another SYNOP message:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_2
more<span class="w"> </span>message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many SYNOP reports are in this file?</p>
</div>
<p>Inspect the station list:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many stations are listed in the station list?</p>
</div>
<p>Convert <code>message.txt</code> to BUFR format.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Based on the results of the exercises in this and the previous exercise, how would you predict the number of
resulting BUFR files based upon the number of SYNOP reports and stations listed in the station metadata file?</p>
</div>
<p>Use BUFR Dump to check each of the output BUFR files contain different WIGOS metadata.</p>
<p>Navigate to the <code>ex_3</code> directory and inspect the SYNOP message:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_3
more<span class="w"> </span>message.txt
</code></pre></div>
<p>This SYNOP message only contains one longer report with more sections.</p>
<p>Inspect the station list:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Is it problematic that this file contains more stations than there are reports in the SYNOP message?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The station list file is simply metadata for <code>synop2bufr</code> to provide further information in processing a SYNOP message.</p>
</div>
<p>Convert <code>message.txt</code> to BUFR format.</p>
<p>Use BUFR Dump to find the following:</p>
<ul>
<li>Air temperature (K) of the report</li>
<li>Total cloud cover (%) of the report</li>
<li>Total period of sunshine (mins) of the report</li>
<li>Wind speed (m/s) of the report</li>
</ul>
<p>Navigate to the <code>ex_4</code> directory and inspect the SYNOP message:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_4
more<span class="w"> </span>message_incorrect.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is incorrect about this SYNOP file?</p>
</div>
<p>Convert <code>message_incorrect.txt</code> using <code>station_list.csv</code></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What problem(s) did you encounter with this conversion?</p>
</div>
<p>Navigate to the <code>ex_5</code> directory and inspect the SYNOP message:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_5
more<span class="w"> </span>message.txt
</code></pre></div>
<p>Inspect the station list:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list_incorrect.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is missing in the station list?</p>
</div>
<p>Convert <code>message.txt</code> to BUFR format.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What problem(s) did you encounter with this conversion?  Were there any message(s) was displayed?</p>
</div>
<p>Considering the error presented, justify the number of BUFR files produced.</p>
<h2 id="practical-sessions-converting-synop-data-to-bufr-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned:</p>
<ul>
<li>the principles of SYNOP data reporting</li>
<li>how to use <code>synop2bufr</code> to convert SYNOP data to BUFR format</li>
<li>how to use <code>bufr_dump</code> to inspect the content of BUFR data</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-converting-csv-data-to-bufr"><h1 id="practical-sessions-converting-csv-data-to-bufr-converting-csv-data-to-bufr">Converting CSV data to BUFR</h1>
<h2 id="practical-sessions-converting-csv-data-to-bufr-introduction">Introduction</h2>
<p>CSV data is a commonly used format for recording tabular data.  <code>csv2bufr</code> is a tool to help
convert CSV to BUFR data.</p>
<p>In this session you will learn to create BUFR data from CSV, using custom and flexible
configuration (mappings) in support of meeting WMO GBON requirements.</p>
<h2 id="practical-sessions-converting-csv-data-to-bufr-preparation">Preparation</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure that you are logged into yoru student VM.</p>
</div>
<p>Navigate to the <code>excercise-materials</code> directory and launch the <strong>csv2bufr</strong> image into a Docker container:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-v<span class="w"> </span>csv2bufr-exercises:/exercises<span class="w"> </span>wmoim/csv2bufr
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The additional flag <code>-v csv2bufr-exercises:/exercises</code> ensures that the directory 'csv2bufr-exercises' on your student VM is accessible as '/exercises' inside your container.</p>
</div>
<h2 id="practical-sessions-converting-csv-data-to-bufr-csv2bufr-primer">csv2bufr primer</h2>
<p>Below are essential <code>csv2bufr</code> commands and configurations:</p>
<h3 id="practical-sessions-converting-csv-data-to-bufr-mappings-create">mappings Create</h3>
<p>The <code>mappings create</code> command creates an empty BUFR mapping template JSON file, which maps CSV column headers to their corresponding ecCodes element:</p>
<div class="highlight"><pre><span></span><code>csv2bufr<span class="w"> </span>mappings<span class="w"> </span>create<span class="w"> </span>&lt;BUFR<span class="w"> </span>descriptors&gt;<span class="w"> </span>--output<span class="w"> </span>&lt;output_dir&gt;
</code></pre></div>
<p>For more information, see the following [example](https://csv2bufr.readthedocs.io/en/latest/example.html#creating-a-new-mapping-file].</p>
<h3 id="practical-sessions-converting-csv-data-to-bufr-data-transform">data transform</h3>
<p>The <code>data transform</code> command converts a CSV file to BUFR format:</p>
<div class="highlight"><pre><span></span><code>csv2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--bufr-template<span class="w"> </span>&lt;my_template.json&gt;<span class="w"> </span>--output-dir<span class="w"> </span>&lt;./my_folder&gt;<span class="w"> </span>&lt;my_data.csv&gt;
</code></pre></div>
<h2 id="practical-sessions-converting-csv-data-to-bufr-eccodes-bufr-refresher">ecCodes BUFR refresher</h2>
<h3 id="practical-sessions-converting-csv-data-to-bufr-bufr_dump">bufr_dump</h3>
<p>The <code>bufr_dump</code> function will allow you to inspect the BUFR files created from the conversion.  It has numerous options;, the following will be most applicable to the exercises:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>&lt;my_bufr.bufr4&gt;
</code></pre></div>
<p>This will display the content of your BUFR on screen.  If you are interested in the values taken by a variable in particular, use the <code>grep</code> command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>&lt;my_bufr.bufr4&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>temperature
</code></pre></div>
<p>This will display the variables related to temperature in your BUFR data.  If you want to do this for multiple types of variables, filter the output using a pipe (<code>|</code>):</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>&lt;my_bufr.bufr4&gt;<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;temperature|wind&#39;</span>
</code></pre></div>
<h2 id="practical-sessions-converting-csv-data-to-bufr-inspecting-csv-data-and-bufr-conversion">Inspecting CSV data and BUFR conversion</h2>
<p>Navigate to the <code>ex_1</code> directory and create a mapping file:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>ex_1
vi<span class="w"> </span>my-mapping.json
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>csv2bufr mappings files have no set file extension, however it recommended to use <code>json</code>.</p>
</div>
<p>Using the <a href="https://confluence.ecmwf.int/display/ECC/WMO%3D38+element+table">ecCodes WMO element table page</a>, create a mapping file of the following variables:</p>
<ul>
<li>WIGOS Station Identifier (series, issuer, issue number, local identifier)</li>
<li>Date (year, month, day)</li>
<li>Time (hour, minute)</li>
<li>Location (latitude, longitude)</li>
<li>Barometer height above sea level</li>
<li>Station level pressure</li>
<li>Air temperature</li>
<li>Relative humidity</li>
</ul>
<p>Open the mapping file you have just created and remove any unused elements.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Look for and delete the elements which have <code>"value": ""</code> (you will notice these elements do not directly correspond to any columns in the CSV file).</p>
</div>
<p>Use the <code>csv2bufr</code> <code>data transform</code> command to convert the file <code>ex_1.csv</code> to BUFR format.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="#practical-sessions-converting-csv-data-to-bufr-csv2bufr-primer">csv2bufr primer</a> section.</p>
</div>
<p>Use BUFR Dump to find the latitude and longitude value stored in the output BUFR file. Verify these values using the CSV file.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See the <a href="#practical-sessions-converting-synop-data-to-bufr-bufr_dump">BUFR primer</a> section.</p>
</div>
<p>Navigate to the <code>ex_2</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_2
</code></pre></div>
<p>Repeat the previous steps, replacing the following elements with their respective BUFR sequences (which have the form <strong>3XXYYY</strong>):</p>
<ul>
<li>WIGOS Station Identifier (series, issuer, issue number, local identifier)</li>
<li>Date (year, month, day)</li>
<li>Time (hour, minute)</li>
<li>Location (latitude, longitude)</li>
</ul>
<p>The <code>BUFR_TableD_en.csv</code> file from the <code>BUFR_tables</code> directory contains the defined BUFR sequences as per the official WMO BUFR code tables.</p>
<p>The first few columns of this file are as follows (important columns are in <strong>bold</strong>):</p>
<ul>
<li>BUFR category (numeric)</li>
<li>BUFR category (name)</li>
<li><strong>BUFR sequence number</strong></li>
<li><strong>BUFR sequence name</strong></li>
<li>BUFR sequence subtitle</li>
<li><strong>Included BUFR element number</strong></li>
<li><strong>Included BUFR element name</strong></li>
</ul>
<p>A given seqeunce will appear multiple times, once for each BUFR element it contains.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Search for the corresponding 6 digit codes found in the previous exercise, and find the corresponding sequence in the 3rd column. For example, the BUFR elements <strong>005002</strong> (Latitude) and <strong>006002</strong> (Longitude) can be replaced with sequence <strong>301023</strong> (Latitude/longitude (coarse accuracy)).</p>
</div>
<p>Navigate to the <code>ex_3</code> directory, and inspect file <code>ex_3.csv</code>.  Compare this file to <code>ex_2.csv</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_3
more<span class="w"> </span>ex_3.csv
more<span class="w"> </span>ex_2.csv
</code></pre></div>
<p>You should notice that the data is the same, however the column names are different.  With this in mind, create a mapping template file for the <code>ex_3.csv</code> file, deleting the redundant elements, and changinge the <code>"value"</code> item to correctly correspond to each column in <code>ex_3.csv</code>.
<div class="highlight"><pre><span></span><code>my-mapping-ex_3.json
</code></pre></div></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In the first column, <code>"eccodes_key": "#1#wigosIdentifierSeries"</code> should now be paired with <code>"value": "data:wigos_identifier_series"</code>.</p>
</div>
<p>Use the csv2bufr <code>data transform</code> function to convert <code>ex_3.csv</code> to BUFR format.</p>
<p>Check that the data stored in the output BUFR is the same as that in the CSV that is was converted from.</p>
<p>Navigate to the <code>ex_4</code> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_4
</code></pre></div>
<p>Here, you are free to either work with your own synoptic CSV data, or use the file <code>ex_4_hourly.csv</code>.</p>
<p>Noting that a SYNOP report cannot contain the WIGOS station identifier, creating a mappings template which contains the mappings for both the WIGOS station identifier and the hourly synoptic data.</p>
<p>Delete all elements in the mapping template that are not present in the CSV data (you should expect to delete most of the file), and edit element names appropriately.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure that <code>number_header_rows</code> and <code>column_names_row</code> are correct.</p>
</div>
<ol>
<li>Convert the CSV data data to BUFR format.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The below steps are optional as time permits:</p>
</div>
<p>Navigate to the <code>ex_5</code> directory and open the file <code>ex_5.csv</code>::</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_5
vi<span class="w"> </span>ex_5.csv
</code></pre></div>
<p>This file contains the same data and column names as <code>ex_2.csv</code>, but uses different units:</p>
<ul>
<li><code>heightOfBarometerAboveMeanSeaLevel</code> is given in $\text{cm}$</li>
<li><code>nonCoordinatePressure</code> is given in $\text{hPa}$</li>
<li><code>airTemperature</code> is given in $^{\circ}\text{C}$</li>
</ul>
<p>Using the <a href="https://confluence.ecmwf.int/display/ECC/WMO%3D38+element+table">ecCodes WMO element table page</a>, find the correct units for these three variables.</p>
<p>Find the scale ($x$, for a multiplication by $10^x$) and offset (addition of a constant $c$) required for each of these conversions.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As $1\text{cm} = 1\text{m}\times 10^{-2}$, the first conversion requires a scale of $x=-2$ and an offset of $c=0$.</p>
</div>
<ol>
<li>Open the mapping file <code>mapping_5.json</code>:</li>
</ol>
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span>mapping_5.json
</code></pre></div>
<p>This the same mapping file as you generated and modified a couple of exercises ago.  Using your answers in the previous question, convert the units using the <code>scale</code> and <code>offset</code> keys.</p>
<p>Convert the file <code>ex_5.csv</code> to BUFR format.</p>
<p>Navigate to the <code>ex_6</code> directory and open the file <code>ex_6.csv</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../ex_6
vi<span class="w"> </span>ex_6.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Notice that this time the <code>relative_humidity</code> column contains an incorrect value.  Why is this value incorrect?</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Think of valid minimum and maximum values for relative humidity.</p>
</div>
<p>By adjusting the <code>valid_min</code> and <code>valid_max</code> keys of the <code>relativeHumidity</code> element in the mapping file <code>mapping_6.json</code>, enforce a quality control measure which prevents this value from being written to BUFR.</p>
<p>Add more valid minimum and maximum values to the mappings file according to your own preference.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The minimum and maximum values must have the <strong>same units</strong> as your <strong>original</strong> input data, not the converted values discussed in the previous exercise.</p>
</div>
<p>Convert the file <code>ex_6.csv</code> to BUFR format, and use <code>bufr_dump</code> to verify that this variable has no value in the resulting BUFR.</p>
<h2 id="practical-sessions-converting-csv-data-to-bufr-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned:</p>
<ul>
<li>the basic usage of <code>csv2bufr</code></li>
<li>how to create and update a simple csv2bufr mapping file for a variety of scenarios, including for GBON requirements, unit conversion, and quality control/range checking</li>
<li>how to <code>csv2bufr</code> on a test data file and convert to BUFR format</li>
<li>how to lookup the BUFR element number for a parameter to be encoded</li>
<li>how to encode BUFR data for the example input data and inspect the resulting output data</li>
<li>about the sequence for hourly climate data</li>
<li>about the BUFR Manual on Codes requirements on the units of variables, e.g. Celsius -&gt; Kelvin.</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-configuring-data-mappings"><h1 id="practical-sessions-configuring-data-mappings-configuring-data-mappings">Configuring data mappings</h1>
<h2 id="practical-sessions-configuring-data-mappings-introduction">Introduction</h2>
<p>wis2box uses a number of configuration files to allow for a simple setup of the system.  At the heart of wis2box
is data ingest and publishing, which are driven by wis2box data mappings.  The basic concept of data mappings
is configuring a WIS2 topic to a defined ingest and publish workflow and files/templates.  In this session, you
will work on adding to the data mappings in support of publishing your data via wis2box.</p>
<h2 id="practical-sessions-configuring-data-mappings-preparation">Preparation</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure you are logged into the <strong>wis2box-management</strong> container on your student VM: </p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/wis2box-setup
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
</div>
<h2 id="practical-sessions-configuring-data-mappings-configure-a-data-mapping">Configure a data mapping</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure you are logged into the <strong>wis2box-management</strong> container before continuing.</p>
</div>
<p>Inspect the wis2box environnment to locate the data mappings in use by the system, as defined by the <code>WIS2BOX_DATA_MAPPINGS</code> environment variable:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>environment<span class="w"> </span>show<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>WIS2BOX_DATA_MAPPINGS
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Where are the live data mappings located?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How can using the <code>$WIS2BOX_DATA_MAPPINGS</code> environment variable be valuable, as compared to <code>/data/wis2box/data-mappings.yml</code>?</p>
</div>
<h3 id="practical-sessions-configuring-data-mappings-add-csv-data">Add CSV data</h3>
<p>Let's add a data mapping for wis2box to process CSV data.  Inspect the contents of the sample SYNOP CSV data mapping:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>~/exercise-materials/wis2box-setup/synop-csv-mappings.yml
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What topic is defined in this mapping?  What values of the topic are placeholders to be updated later in this session?</p>
</div>
<p>Copy and paste the above file contents into the <code>$WIS2BOX_DATA_MAPPINGS</code> file (either manually or via the command below)::</p>
<div class="highlight"><pre><span></span><code>tail<span class="w"> </span>-n<span class="w"> </span>+2<span class="w"> </span>exercise-materials/wis2box-setup/test-data/data-mappings.yml<span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$WIS2BOX_DATA_MAPPINGS</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Be sure that the first <code>data:</code> line from the above file is omitted when copying/pasting into the <code>$WIS2BOX_DATA_MAPPINGS</code> file.</p>
</div>
<p>Open the data mappings file:</p>
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span><span class="nv">$WIS2BOX_DATA_MAPPINGS</span>
</code></pre></div>
<p>Verify that the file you copied from <code>~/exercise-materials/wis2box-setup/synop-csv-mappings.yml</code> is now part of the live data mappings file.</p>
<p>Update the <code>[country]</code> and <code>[centre_id]</code> values in your new/added data mapping.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code>country</code> value should match one of the countries in the <a href="https://github.com/wmo-im/wis2-topic-hierarchy/blob/main/topic-hierarchy/country.csv">country list of the WIS2 Topic Hierarchy</a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code>centre_id</code> value should match one of the countries in the <a href="https://github.com/wmo-im/wis2-topic-hierarchy/blob/main/topic-hierarchy/country.csv">country list of the WIS2 Topic Hierarchy</a> and <code>centre_id</code> values should be lower case and contain no accents or special characters. Dashes should be used instead of underscores.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>file-pattern</code> values throughout the data mapping provide a <a href="https://www.regular-expressions.info">regular expression</a> to be able to match filenames.  Ensure your filenames are formatted as per the regular expression in the new data mapping, to include <code>WIGOS_</code> as a fixed value, followed by the WIGOS Station Identifier (WSI), followed by an underscore (<code>_</code>), as well as any other information (i.e. datestamp).  Ensure the file extension is <code>.csv</code>.  An real world example would be <code>WIGOS_0-454-2-AWSBALAKA_2021-11-18T0955.csv</code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>centre id's will officially managed and introduced as part of the WIS2 Topic Hierarchy throughout the WIS2 Pilot Phase.</p>
</div>
<h2 id="practical-sessions-configuring-data-mappings-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned how to:</p>
<ul>
<li>inspect the live wis2box data mappings</li>
<li>add a new data mapping</li>
<li>update the <code>country</code> and <code>centre_id</code> values add a new data mapping</li>
<li>update the <code>file-pattern</code> value to match your data filename convention</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-configuring-wis2-discovery-metadata"><h1 id="practical-sessions-configuring-wis2-discovery-metadata-configuring-wis2-discovery-metadata">Configuring WIS2 discovery metadata</h1>
<p>As described in the <a href="#overviews">overviews</a>, WIS2 requires discovery metadata to be provided describing
your data to be shared to WIS2 Global Services.  This session will walk you through creating and publishing
discovery metadata from wis2box from a configuration file.</p>
<h2 id="practical-sessions-configuring-wis2-discovery-metadata-preparation">Preparation</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure you are running MQTT Explorer and you are connected to the broker on your student VM before continuing.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure you are logged into the <strong>wis2box-management</strong> container on your student VM: </p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/wis2box-setup
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
</div>
<h2 id="practical-sessions-configuring-wis2-discovery-metadata-creating-discovery-metadata">Creating discovery metadata</h2>
<p>Copy the test discovery metadata into your own file (you may name the file whatever you wish):</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>~/exercise-materials/wis2box-setup/test-data/mwi-surface-weather-observations.yml<span class="w"> </span>~/my-discovery-metadata.yml
</code></pre></div>
<p>Inspect the sample discovery metadata:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>~/my-discovery-metadata.yml
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All values in the discovery metadata configuration are required and shoud be included.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How does line 3 of your discovery metadata file relate to the new data mapping in the previous session?</p>
</div>
<p>Update the following values in the discovery metadata configuration:</p>
<ul>
<li><code>wis2box.topic_hierarchy</code>: the topic hierarchy that categorizes the data (this value should be the same as the definition in your newly create data mapping).</li>
<li><code>wis2box.country</code>: 3-letter country code in lower case</li>
<li><code>wis2box.centre_id</code>: your centre id as defined in the previous exercise</li>
<li><code>metadata.identifier</code>: a unique identifier consisting of <code>urn:x-wmo:md:[country]:[centre_id]:[dataset_name]</code>, where <code>[dataset-name]</code> can be any name of your choosing</li>
<li><code>identification.title</code>: a human readable title describing your data</li>
<li><code>identification.abstract</code>: a human readable description describing your data</li>
<li><code>identification.dates.creation</code>: when the discovery metadata was created (today's date)</li>
<li><code>identification.extents.spatial (bbox)</code>: the bounding box coordinates of your data (minimum longitude, minimum latitude, maximum longitude, maximum latitude), in decimal degrees</li>
<li><code>identification.extents.temporal (begin)</code>: the begin and end time of your data (keeping the end time to <code>null</code> is suitable to ongoing observations)</li>
<li><code>contact.pointOfContact</code>: your organization's point of contact information</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The configuration is based on the YAML format.  Ensure your config is propertly indented (4 spaces).</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Ensure that bbox values are correctly signed (for example, use the minus sign [<code>-</code>] for southern or western hemispheres.</p>
</div>
<h2 id="practical-sessions-configuring-wis2-discovery-metadata-publishing-discovery-metadata">Publishing discovery metadata</h2>
<p>Run the following command to publish your discovery metadata:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>metadata<span class="w"> </span>discovery<span class="w"> </span>publish<span class="w"> </span>~/my-discovery-metadata.yml
</code></pre></div>
<p>Ensure that your discovery metadata was published to the API, by navigating to <code>http://&lt;your-host&gt;/oapi/collections/discovery-metadata</code>.</p>
<p>Ensure that your discovery metadata was also published to the broker, by looking for a new metadata message in MQTT Explorer.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Do you see your new discovery metadata in the API?</p>
</div>
<p>Click on your discovery metadata record and inspect the content, noting how it relates to the discovery metadata configuration created earlier in this session.</p>
<p>Update the title of your discovery metadata, and re-publish:</p>
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span>~/my-discovery-metadata.yml
wis2box<span class="w"> </span>metadata<span class="w"> </span>discovery<span class="w"> </span>publish<span class="w"> </span>~/my-discovery-metadata.yml
</code></pre></div>
<p>Ensure that your discovery metadata updates were published to the API, by refreshing the page to your discovery metadata.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Are you able to see the updates you made in the configuration?</p>
</div>
<p>Feel free to update additional values and re-publishing your discovery metadata to get a better idea of how and where discovery metadata content is updated.</p>
<h2 id="practical-sessions-configuring-wis2-discovery-metadata-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned how to:</p>
<ul>
<li>create discovery metadata</li>
<li>publish discovery metadata</li>
<li>update and re-publish discovery metadata</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-configuring-station-metadata"><h1 id="practical-sessions-configuring-station-metadata-configuring-station-metadata">Configuring station metadata</h1>
<p>wis2box requires station metadata to be able to process and publish observations to WIS2.
This session will walk you through creating and publishing station metadata from wis2box
from a configuration file.  wis2box uses a fixed station metadata list that is used as
part of its runtime operation.</p>
<h2 id="practical-sessions-configuring-station-metadata-preparation">Preparation</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure you are logged into the <strong>wis2box-management</strong> container on your student VM: </p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/exercise-materials/wis2box-setup
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
</div>
<h2 id="practical-sessions-configuring-station-metadata-creating-station-metadata">Creating station metadata</h2>
<p>Update the file <code>~/exercises-metadata/test-data/metadata/station/station_list.csv</code>, adding your new station:</p>
<div class="highlight"><pre><span></span><code>vi<span class="w"> </span>~/exercises-metadata/test-data/metadata/station/station_list.csv
</code></pre></div>
<p>For each new station, add a row to the end of the file with the following values:</p>
<ul>
<li><code>station_name</code>: the human readable name of the station</li>
<li><code>wigos_station_identifier</code>: the WSI issued for the station</li>
<li><code>traditional_station_identifier</code>: the traditional station identifier if a WSI does not exist</li>
<li><code>facility_type</code>: the station/platform type (use <strong>Land (fixed)</strong> for land stations)</li>
<li><code>latitude</code>: the latitude, in decimal degrees</li>
<li><code>longitude</code>: the longitude, in decimal degrees</li>
<li><code>elevation</code>: station elevation, in metres above sea level</li>
<li><code>territory_name</code>: the human readable country name</li>
<li><code>wmo_region</code>: the Roman numeral of your country based on WMO Regional Associations</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can also derive your station information from the <a href="https://oscar.wmo.int/surface">WMO OSCAR/Surface</a> system.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Ensure that latitude and longitude values are correctly signed (for example, use the minus sign [<code>-</code>] for southern or western hemispheres.</p>
</div>
<h2 id="practical-sessions-configuring-station-metadata-publishing-station-metadata">Publishing station metadata</h2>
<p>Run the following command to publish your station metadata:</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>metadata<span class="w"> </span>station<span class="w"> </span>discovery<span class="w"> </span>publish-collection
</code></pre></div>
<p>Ensure that your new station metadata was published to the API, by navigating to <code>http://&lt;your-host&gt;/oapi/collections/stations</code>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Do you see your new station metadata?</p>
</div>
<p>Click on your station metadata record and inspect the content, noting how it relates to the station list configuration updated earlier in this session.</p>
<h2 id="practical-sessions-configuring-station-metadata-conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session, you learned how to:</p>
<ul>
<li>update station metadata</li>
<li>publish station metadata</li>
</ul>
</div></section><section class="print-page" id="practical-sessions-data-ingest-and-monitoring"><h1 id="practical-sessions-data-ingest-and-monitoring-data-ingest-and-monitoring">Data ingest and monitoring</h1>
<p>In this session you will learn various ways to ingest data into your wis2box and learn how you can monitor if your data is being ingested without errors.</p>
<p>Note that the starting point for wis2box workflow is the MinIO container publishing a message on the <code>wisbox-storage/#</code> topic on the local broker.</p>
<h2 id="practical-sessions-data-ingest-and-monitoring-preparation">Preparation</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before starting please login to your student-VM and ensure your wis2box is started and all services are up:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
</div></section><section class="print-page" id="practical-sessions-downloading-data-from-wis2"><h1 id="practical-sessions-downloading-data-from-wis2-downloading-data-from-wis2">Downloading data from WIS2</h1></section><h1 class='nav-section-title-end'>Ended: Practical sessions</h1>
                        <h1 class='nav-section-title' id='section-cheatsheets'>
                            Cheatsheets <a class='headerlink' href='#section-cheatsheets' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="cheatsheets-linux"><h1 id="cheatsheets-linux-linux-cheatsheet">Linux cheatsheet</h1>
<h2 id="cheatsheets-linux-overview">Overview</h2>
<p>The basic concepts of working in a Linux operating system are <strong>files</strong> and <strong>directories</strong> (folders) organized in
a tree structure within an <strong>environment</strong>.</p>
<p>Once you login to a Linux system, you are working in a <strong>shell</strong> in which you can work on files and directories,
by executing commands which are installed on the system.  The Bash shell is a common and popular shell which
is typically found on Linux systems.</p>
<h2 id="cheatsheets-linux-bash">Bash</h2>
<h3 id="cheatsheets-linux-directory-navigation">Directory Navigation</h3>
<ul>
<li>Entering an absolute directory:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/dir1/dir2
</code></pre></div>
<ul>
<li>Entering a relative directory:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>./somedir
</code></pre></div>
<ul>
<li>Move one directory up:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<ul>
<li>Move two directories up:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>../..
</code></pre></div>
<ul>
<li>Move to your "home" directory:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>-
</code></pre></div>
<h3 id="cheatsheets-linux-file-management">File Management</h3>
<ul>
<li>Listing files in the current directory:</li>
</ul>
<div class="highlight"><pre><span></span><code>ls
</code></pre></div>
<ul>
<li>Listing files in the current directory with more detail:</li>
</ul>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l
</code></pre></div>
<ul>
<li>List the root of the filessystem:</li>
</ul>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-l<span class="w"> </span>/
</code></pre></div>
<ul>
<li>Create an empty file:</li>
</ul>
<div class="highlight"><pre><span></span><code>touch<span class="w"> </span>foo.txt
</code></pre></div>
<ul>
<li>Create a file from an <code>echo</code> command:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;hi there&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>Copy a file:</li>
</ul>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>file1<span class="w"> </span>file2
</code></pre></div>
<ul>
<li>Concatenate two files into a new file called <code>newfile</code>:</li>
</ul>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>file1<span class="w"> </span>file2<span class="w"> </span>&gt;<span class="w"> </span>newfile
</code></pre></div>
<ul>
<li>Append another file into <code>newfile</code></li>
</ul>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>file3<span class="w"> </span>&gt;&gt;<span class="w"> </span>newfile
</code></pre></div>
<ul>
<li>Delete a file:</li>
</ul>
<div class="highlight"><pre><span></span><code>rm<span class="w"> </span>newfile
</code></pre></div>
<ul>
<li>Delete all files with the same file extension:</li>
</ul>
<div class="highlight"><pre><span></span><code>rm<span class="w"> </span>*.dat
</code></pre></div>
<ul>
<li>Create a directory</li>
</ul>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>dir1
</code></pre></div>
<h3 id="cheatsheets-linux-chaining-commands-together-with-pipes">Chaining commands together with pipes</h3>
<p>Pipes allow a user to send the output of one command to another using the pipe <code>|</code> symbol:</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;hi&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/hi/bye/&#39;</span>
</code></pre></div>
<ul>
<li>Filtering command outputs using grep:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;id,title&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>test-file.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;1,birds&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>test-file.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;2,fish&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>test-file.txt
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;3,cats&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>test-file.txt

cat<span class="w"> </span>test-file.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>fish
</code></pre></div>
<ul>
<li>Ignoring case:</li>
</ul>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>-i<span class="w"> </span>FISH<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>Count matching lines:</li>
</ul>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>-c<span class="w"> </span>fish<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>Return outputs not containing keyword:</li>
</ul>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>-v<span class="w"> </span>birds<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>Count the number of lines in <code>test-file.txt</code>:</li>
</ul>
<div class="highlight"><pre><span></span><code>wc<span class="w"> </span>-l<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>Display output one screen at a time:</li>
</ul>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>test-file.txt
</code></pre></div>
<p>...with controls:</p>
<ul>
<li>Scroll down line by line: <em>enter</em></li>
<li>Go to next page: <em>space bar</em></li>
<li>
<p>Go back one page: <em>b</em></p>
</li>
<li>
<p>Display the first 3 lines of the file:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>head<span class="w"> </span>-3<span class="w"> </span>test-file.txt
</code></pre></div>
<ul>
<li>Display the last 2 lines of the file:</li>
</ul>
<div class="highlight"><pre><span></span><code>tail<span class="w"> </span>-2<span class="w"> </span>test-file.txt
</code></pre></div></section><section class="print-page" id="cheatsheets-docker"><h1 id="cheatsheets-docker-docker-cheatsheet">Docker cheatsheet</h1>
<h2 id="cheatsheets-docker-overview">Overview</h2>
<p>Docker allows for creating virtual envronments in an isolated manner in support
of virtualization of computing resources.  The basic concept behind Docker is containerization,
where software can run as services, interacting with other software containers, for example.</p>
<p>The typical Docker workflow involves creating and building <strong>images</strong>, which are then run as live <strong>containers</strong>.</p>
<h3 id="cheatsheets-docker-image-management">Image management</h3>
<ul>
<li>List available images</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>images
</code></pre></div>
<ul>
<li>Build an image from a Dockerfile:</li>
</ul>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; Dockerfile</span>
<span class="s">FROM ubuntu:latest</span>

<span class="s">RUN apt-get update</span>
<span class="s">RUN apt-get install –y nginx</span>

<span class="s">CMD [&quot;echo&quot;, &quot;Hello from my first Docker setup!&quot;]</span>
<span class="s">EOF</span>
</code></pre></div>
<ul>
<li>Building the image:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-image:local<span class="w"> </span>.
</code></pre></div>
<ul>
<li>Removing an image:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rmi<span class="w"> </span>my-image:local
</code></pre></div>
<h3 id="cheatsheets-docker-volume-management">Volume Management</h3>
<ul>
<li>List all created volumes:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>ls
</code></pre></div>
<ul>
<li>Create a volume:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>create<span class="w"> </span>my-volume
</code></pre></div>
<ul>
<li>Display detailed information on a volume:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>inspect<span class="w"> </span>my-volume
</code></pre></div>
<ul>
<li>Remove a volume:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>rm<span class="w"> </span>my-volume
</code></pre></div>
<ul>
<li>Remove all unused volumes:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>prune
</code></pre></div>
<h3 id="cheatsheets-docker-container-management">Container Management</h3>
<ul>
<li>Create a container from an image, with an interactive terminal (<code>-it</code>) and a mounted volume (<code>v</code>):</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">pwd</span><span class="si">}</span>:/app<span class="w"> </span>my-image:local
</code></pre></div>
<ul>
<li>Display a list of currently running containers:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps
</code></pre></div>
<ul>
<li>List of all containers:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps<span class="w"> </span>-a
</code></pre></div>
<ul>
<li>Start a container:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>start<span class="w"> </span>my-image:local<span class="w">  </span><span class="c1"># starts a new container</span>
</code></pre></div>
<ul>
<li>Enter the interactive terminal of a running container:</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>use <code>docker ps</code> to use the container id in the command below</p>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>my-container<span class="w"> </span>/bin/bash
</code></pre></div>
<ul>
<li>Remove a container</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rm<span class="w"> </span>my-container
</code></pre></div>
<ul>
<li>Remove a running container:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>my-container
</code></pre></div></section><section class="print-page" id="cheatsheets-wis2box"><h1 id="cheatsheets-wis2box-wis2-in-a-box-cheatsheet">WIS2 in a box cheatsheet</h1>
<h2 id="cheatsheets-wis2box-overview">Overview</h2>
<p>wis2box runs as a suite of Docker Compose commands.  The <code>wis2box-ctl.py</code> command is a utility
(written in Python) to run Docker Compose commands easily.</p>
<h2 id="cheatsheets-wis2box-wis2box-command-essentials">wis2box command essentials</h2>
<h3 id="cheatsheets-wis2box-building">Building</h3>
<ul>
<li>Build all of wis2box:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>build
</code></pre></div>
<ul>
<li>Build a specific wis2box Docker image:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>build<span class="w"> </span>wis2box-management
</code></pre></div>
<ul>
<li>Update wis2box:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>update
</code></pre></div>
<h3 id="cheatsheets-wis2box-starting-and-stopping">Starting and stopping</h3>
<ul>
<li>Start wis2box:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
</code></pre></div>
<ul>
<li>Stop wis2box:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>stop
</code></pre></div>
<ul>
<li>Verify all wis2box containers are running:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
<ul>
<li>Login to a wis2box container (<em>wis2box-management</em> by default):</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<ul>
<li>Login to a specific wis2box container:</li>
</ul>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2box-api
</code></pre></div>
<h3 id="cheatsheets-wis2box-design-time-commands-metadata-management-and-publishing">Design time commands (metadata management and publishing)</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must be logged into the <strong>wis2box-management</strong> container to run the below commands</p>
</div>
<ul>
<li>Publish discovery metadata:</li>
</ul>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>metadata<span class="w"> </span>discovery<span class="w"> </span>publish<span class="w"> </span>/path/to/discovery-metadata-file.yml
</code></pre></div>
<ul>
<li>Publish station metadata:</li>
</ul>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>metadata<span class="w"> </span>station<span class="w"> </span>publish-collection
</code></pre></div>
<ul>
<li>Add a dataset of observation collections from discovery metadata:</li>
</ul>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>add-collection<span class="w"> </span>/path/to/discovery-metadata-file.yml
</code></pre></div>
<ul>
<li>Ingest data into the <em>wis2box-incoming</em> bucket to trigger processing and publishing:</li>
</ul>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>ingest<span class="w"> </span>--topic-hierarchy<span class="w"> </span>topic.hierarchy.path<span class="w"> </span>--path<span class="w"> </span>/path/to/directory/of/data/files
</code></pre></div></section><h1 class='nav-section-title-end'>Ended: Cheatsheets</h1></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "/wis2box-training/", "features": ["navigation.indexes"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>